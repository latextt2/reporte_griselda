\chapter{Dise\~no Detallado}
\section{Rodamiento magnético radial}

El Rodamiento Magnético Radial (RMR) consiste en un conjunto de electroimanes colocados en una circunferencia, de manera que sus campos magnéticos puedan ejercer una fuerza arbitraria en su plano de acción. Para controlar la fuerza que cada electroimán ejerce se tiene un circuito de accionamiento, que alimenta las bobinas del electroimán con la corriente necesaria.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.625\textwidth]{images/Capitulo_3/diagrama_funcional_rmr}
    \caption{Diagrama funcional del rodamiento magnético radial.}
\end{figure}

\newpage

\subsection{Número de polos} \label{sec:numero-polos}

Antes de diseñar los electroimanes es necesario determinar en número de polos que conformarán el EIR.
Suponiendo que tenemos $N$ polos, la distancia angular $\alpha$ entre ellos será de $360/N$ (fig. \ref{fig:rmr:diagrama-de-polos}). El EIR debe ser capaz de generar una fuerza arbitraria $F_r$ dentro del plano $YZ$. Teniendo en cuenta que los electroimanes sólo son capaces de ejercer fuerzas de atracción sobre los materiales ferromagnéticos. La fuerza $F_r$ deberá ser proporcionada únicamente por las fuerzas de los electroimanes adyacentes $F_1$ y $F_2$ (fig. \ref{fig:rmr:diagrama-de-fuerzas}).  

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_3/diagrama_polos}
        \caption{Posición de los polos.}
        \label{fig:rmr:diagrama-de-polos}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_3/diagrama_fuerza_polos}
        \caption{Diagrama de Fuerzas.}
        \label{fig:rmr:diagrama-de-fuerzas}
    \end{subfigure}
    \caption{Polos del electroimán radial.}
\end{figure}

Se define a $\theta$ como el ángulo entre la fuerzas $F_r$ y $F_1$. Luego entonces, para una fuerza de magnitud $F_r$, las magnitudes de las fuerzas $F_1$ y $F_2$ serán: 
\begin{equation}
    F_1 = F_r (\frac{cos \theta - sin \theta}{tan \alpha})
\end{equation}
\begin{equation}
    F_2 = F_r (\frac{sin \theta}{sin \alpha} )
\end{equation}

Analizando los casos críticos: 1) donde $F_r$ esta alineado con $F_1$ ($\theta = 0$), 2) donde $F_r$ esta orientado en medio de $F_1$ y $F_2$ ($\theta = \alpha/2)$ y 3) donde $F_r$ esta alineado con $F_2$ ($\theta = \alpha$); se vuelve clara la forma en la que el número de polos afecta tanto la fuerza máxima como la eficiencia del sistema.

Para los casos 1 y 3 toda la fuerza es ejercida por los electroimanes $E1$ y $E2$ respectivamente, con fuerzas de $F_1 = F_r, F_2 = 0$ para el caso 1, y $F_1 = 0, F_2 = F_r$ para el caso 3. Como lo indica la ecuación:

\begin{equation}
P = (\frac{R F}{K_e} )
\end{equation}

Tendremos un consumo de magnitud $(\frac{R F_r}{K_e} )$. %, lo mismo sucede en el caso 3, 

En cambio en el caso 2 la fuerza tiene que ser proporcionada por F1 y F2 en partes iguales, y con una magnitud de:

\begin{equation}
F = F_1 = F_2 = (\frac{F_r sin (\frac{\alpha}{2}) }{sin \alpha} ) 
\end{equation}

Lo cual corresponde a una pérdida de:

\begin{equation}
P = 2 (\frac{R F_r}{K_e} ) \label{eq:cosumo-electroiman-caso-especial}
\end{equation}

Para que el rodamiento axial pueda ejercer fuerzas en cualquier dirección del plano YZ es necesario un mínimo de 3 polos. Sin embargo, incrementar el número de polos reduce el consumo en las regiones intermedias (ecuación \ref{eq:cosumo-electroiman-caso-especial}), ya que no estamos utilizando corriente para generar componentes de fuerza que terminarán por cancelarse mutuamente.

En \cite{cite_s13_2017_matsuda2007_polos} se estudia de manera más detallada los efectos de variar el número de polos en un RMR, se concluye que utilizar 6 polos minimiza el diámetro exterior para una capacidad dada.

\subsection{Electroimán}

\subsubsection{Selecci\'on de Material} \label{sec:seleccion-somaloy}

En el caso de las aplicaciones de electroimanes, lo ideal es utilizar materiales con un alto punto de saturación y permeabilidad relativa. El punto de saturación limita la fuerza máxima que puede ejercer un electroimán [vease sección \ref{sec:diseno-elec}] y al tener una permeabilidad relativa alta podemos confiar que la mayoría del flujo magnético circula dentro del núcleo. 

Entre los materiales con estas características encontramos ferritas y aleaciones de hierro laminadas. Las ferritas poseen una alta permeabilidad pero tienen un punto de saturación más bajo, mientras que las aleaciones de hierro poseen un punto de saturación más alto y permeabilidad intermedia. Estos últimos al ser conductores presentan pérdidas por corrientes parásitas (corrientes de Foucault) que disminuye la eficiencia total del electroimán.  

\begin{table}[H]
\centering
\begin{tabular}{|l|c|c|c|c|c|c|}
\hline
\multicolumn{1}{|c|}{\textbf{Fabricante}} & \textbf{Clave} & \textbf{Material Base} & \textbf{$\mu_i$} & \textbf{$B_s$ {[}mT{]}} & \textbf{$H_c$ {[}A/m{]}} & \textbf{$f_{max}$ {[}Hz{]}} \\ \hline
TDK {[}Anexo C{]} & PC90 & MnZn & 2200 & 540 & 13 & 300k \\ \hline
TDK {[}Anexo E{]} & N27 & MnZn & 2000 & 500 & 23 & 150k \\ \hline
Ferroxcube {[}Anexo F{]} & 3C98 & MnZn & 2500 & 530 & 12 & 400k \\ \hline
MMG \cite{cite_s22_2017_SoftFerrite} & F44 & MnZn & 2500 & 470 & 15 & 500k \\ \hline
NEC \cite{cite_s23_2017_FerriteCores} & BH3 & MnZn & 1800 & 540 & 15 & 400k \\ \hline
\end{tabular}
\caption{Propiedades de diferentes Ferritas MnZn.}
\end{table}

Como alternativa a los anteriores existen nuevos materiales como el Somaloy y Permalloy, estos son aleaciones de níquel-hierro que gracias a su proceso de sinterización les permite alcanzar altos puntos de saturación y permeabilidad relativa sin ser conductores. 

El Permalloy posee un punto de saturación de 1.6 T y una permeabilidad relativa de 2500\cite{cite_s1_2017}, mientras que el Somaloy 3P posee un punto de saturación de entre 1.42 y 1.63 y una permeabilidad relativa de 950 [véase anexo D]. 

A pesar de que el Permalloy posee mejores características, la empresa fabricante del Somaloy proporciona una documentación más extensa en cuanto a las características de este como son: curva de saturación a diferentes temperaturas, curvas de respuesta en frecuencia y caracterización de pérdidas. Estos datos son de suma importancia al momento de realizar una simulación y por eso se seleccionó el Somaloy como el material del núcleo.      

\subsubsection{Núcleo ferromagnético}

De acuerdo a las especificaciones definidas en la sección \ref{sec:PDS} se estableció una fuerza mínima de:  

$$F_{min} = 50[N]$$

Al tratarse de un rodamiento con fines demostrativos, se propuso esa fuerza para que el resultado final ocupe el menor espacio posible.

El problema de seleccionar una distancia de operación recae en que una distancia muy grande requiere una mayor inducción magnética para generar una fuerza determinada, mientras que con una distancia pequeña es más fácil generar la misma fuerza con la desventaja de que se alcanza el punto de saturación con mayor rapidez. Además, si la distancia es muy pequeña hay poco espacio para estabilizarlo. 
 
En la literatura podemos identificar una distancia de operación mínima de $0.5 mm$ \citep{cite_s11_2017_Magnetic_Bearings_design} por lo que se optó por trabajar con un rango de:

$$y_{max} = 0.75[mm]$$
$$y_{min} = 0.25[mm]$$

Teniendo en cuenta las características del material seleccionado y las condiciones de operación descritas anteriormente se procede a utilizar las fórmulas de la sección \ref{sec:diseno-elec}. 

$$A = 12 * 24 = 288[mm^2]$$

\subsubsection{Cálculo de la bobina} \label{sec:radial-calculo-bobina}

Como se explica en la sección \ref{sec:calc-conductores}, la relación entre el número de vueltas y la corriente depende del balance entre eficiencia y respuesta en frecuencia. Se optó por utilizar una corriente de 2 A debido a la gran disponibilidad de componentes electrónicos que operan a este valor de corriente, además de ser un valor lo suficientemente alto como para que la inductancia no degrade la respuesta en frecuencia del electroimán. 

$$I = 2[A]$$

De acuerdo a la tabla \ref{tabla:AWG-COBRE} para una corriente de 2 A corresponde a un calibre AWG de:

\begin{table}[H]
\centering
\begin{tabular}{|c|l|c|c|c|c|}
\hline 
AWG & Di\'ametro & Area\;($mm^2$) & Resistencia (ohms/km) & Corriente Máxima & Frecuencia Máxima\\ 
\hline 
18 & 1.023 & 0.823 & 20.94 & 2.3 & 17 $kHz$ \\
\hline  
\end{tabular} 
\caption{Especificaciones técnicas para el alambre de cobre esmaltado AWG 18.}
\label{tabla:awg-18}
\end{table}

Aplicando la siguiente fórmula para determinar el número de vueltas, obtenemos que:

\begin{equation}
N = \frac{NI_{max}}{I} = 314 [vueltas] \label{eq:vueltas-bobina}
\end{equation}

A través de la fórmula \ref{eq:area-bobina} y con las especificaciones del alambre esmaltado seleccionado, obtenemos la sección transversal de la bobina de:

$$A_b = 287.13 \; mm^2 \; \approx \; 288 \; mm^2$$

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/electroiman_radial_final}
    \caption{Dimensiones del Electroimán Radial.}
\end{figure}

\newpage

\subsection{Simulación FEM} \label{sec:simulacion-fem-electroiman}

Con el fin de validar los cálculos y comprobar que el núcleo no alcance su punto de saturación, se realizó una simulación de elemento finito con ayuda del software FEMM donde se obtuvieron los siguientes resultados:

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/simulacion_radial}
    \caption{Simulación del electroimán radial en FEMM.}
    \label{fig:simulacion-femm-radial}
\end{figure}

En la figura \ref{fig:simulacion-femm-radial} se puede observar que el valor máximo de inducción magnética es de $0.917 T$ lo cuál está por debajo del punto de saturación del material.

Existe una diferencia entre el modelo ideal y la simulación. Esta diferencia se debe a los efectos de la reluctancia del núcleo. Un modelo que incluya la reluctancia del núcleo se acerca más al modelo real tal y como se muestra en la figura \ref{fig:curva-fuerza-rmr}.

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/simulacion_vs_modelo_radial}
    \caption{Curva Fuerza - Distancia del RMR.}
    \label{fig:curva-fuerza-rmr}
\end{figure}

\newpage

\subsection{Electrónica de accionamiento}

Ahora que conocemos las características de los electroimanes, es necesario un circuito para controlar la corriente que circula por la bobinas. Para este punto ya conocemos las características eléctricas de las bobinas como la inductancia y la resistencia. Estos datos nos servirán mas adelante para calcular una circuiteria con un bajo índice de pérdidas. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/Capitulo_3/MOSFET_1}
    \caption{Amplificador lineal.}
    \label{fig:amplificador-lineal}
\end{figure}

Un amplificador que opera en modo lineal, como el de la figura \ref{fig:amplificador-lineal}, opera de la siguiente manera: supongamos que tenemos que hacer pasar una corriente de 1 ampere a través de una carga de 10 Ohms, para que exista 1 ampere se necesitan 10 volts. Si nuestra fuente es de 20 volts esto implica que el transistor debe de absorber los 10 volts restantes. Esto implica disipar 10 W de potencia en forma de calor. Entonces es evidente la baja eficiencia que resulta operar de este modo.

En cambio si operamos en el modo de saturación tendríamos en las terminales del transistor 0 volts y 20 amperes, mientras que en la zona de corte tendriamos 20 volts y 0 amperes. Ambas situaciones corresponden a una potencia disipada de 0 W en el transistor. En otras palabras, la disipación de energía en forma de calor es mínima. 

Para regular la corriente que circula conmutamos de un estado a otro de manera que el promedio de la corriente sea la corriente deseada.

De manera pragmática, esta conmutación se realiza mediante transistores MOSFET debido a su baja resistencia en encendido Ron. El MOSFET es un dispositivo que controla la corriente a través del voltaje aplicado en sus terminales, donde la relación entre estas se encuentra determinada por:

\begin{equation}
I_d = G(V_g - V_{th})^2
\end{equation}

Donde $V_{th}$, conocido como voltaje de treshhold, es el voltaje mínimo para activar el transistor. Una vez el voltaje de compuerta $Vg$ llega sobrepasa el valor $V{sat}$ el transistor no deja incrementar más la corriente y simplemente se comporta como una resistencia de valor $R_{on}$. A este modo de operación se le conoce como saturación.

Cuando se trata de conmutar una carga inductiva se generan picos de voltaje, pues la corriente que circula por un inductor no puede cambiar de manera instantánea o discontinua. Es por eso que se necesita de un diodo para proveer un camino por el que la corriente logre recircular y disminuir de manera controlada.

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_3/MOSFET_2}
        \caption{Circuito con diodo de recirculación.}
        \label{fig:circuito-recirculacion}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_3/Grafica_Accionamiento_simple}
        \caption{Carga y descarga del inductor.}
        \label{fig:carga-descarga-inductor-simple}
    \end{subfigure}
\end{figure}

La razón de cambio en la corriente en un inductor depende del voltaje aplicado en sus terminales. En el circuito \ref{fig:circuito-recirculacion}, cuando el transistor está activado el voltaje en las terminales es $V_{cc} \approx 20 V$, y cuando está desactivado (y la corriente circula por el diodo) el voltaje en las terminales es el voltaje de diodo $V_d \approx 0.5 V$. Entonces los valores de carga y descarga del inductor serán de:

\begin{equation}
\frac{di}{dt}_{on} = \frac{V_{cc}}{L}
\end{equation}

\begin{equation}
\frac{di}{dt}_{off} = \frac{-2V_{cc}}{L}
\end{equation}

El problema es que el incremento y decremento de la corriente actúan de forma asimétrica (fig. \ref{fig:carga-descarga-inductor-simple}), entonces para obtener cargas y descargas simétricas será necesario aplicar un voltaje de $-V_{cc}$ durante el ciclo de descarga. Para eso es necesaria una configuración como la mostrada en la figura \ref{fig:puente-h}.

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_3/Puente_H}
        \caption{Circuito de Puente H.}
        \label{fig:puente-h}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_3/Grafica_accionamiento_avanzado}
        \caption{Carga y descarga rápida.}
        \label{fig:carga-descarga-rapida}
    \end{subfigure}
\end{figure}

Esta configuración es comúnmente conocida como puente "H" e implica varios detalles para su implementación, el primero de estos es la activación de los transistores. Como ya se ha mencionado, para operar de la manera más eficiente es necesario llevar los transistores a su punto de saturación, en la mayoría de los transistores de potencia el voltaje de compuerta en saturación $V_{sat}$ oscila entre los 10 y 15 volts, y dado que la mayoría de los circuitos de procesamiento operan entre los 5 y 1.8 volts, es necesario de un circuito complementario para elevar los niveles de voltaje. No hacer esto causaría la polarización de los transistores en la zona lineal, lo que resultaría en el calentamiento de estos y una operación con baja eficiencia. 

Otro problema consiste en polarizar los transistores de la figura \ref{fig:puente-h}, ya que para su correcta activación es necesario un voltaje de compuerta de hasta $V_{cc} + V{sat}$. 

Ambos problemas son solucionados mediante el uso de un circuito conocido como Gate Driver, donde se usa un arreglo de transistores, diodos y capacitores para proveer los voltajes correctos en las compuertas de los transistores sin necesidad de una fuente separada.

Suponiendo que queremos mantener constante la corriente del inductor podemos desactivar todos los transistores dejándolos recircular por los diodos. Cuando la corriente recircula por los diodos, ésta disminuye en una razón de:

\begin{equation}
\frac{di}{dt} = \frac{-2V_d}{L}
\end{equation}

Como la resistencia de los transistores Ron es baja, si activamos los transistores 1 y 2 recirculando la corriente por estos la tasa de cambio será:

\begin{equation}
\frac{di}{dt} = \frac{R i}{L}
\end{equation}

A este modo de operación se le conoce como rectificación síncrona. Esto no se puede realizar con transistores bipolares, pero si con transistores MOSFET. 

Podemos definir ahora dos estados de operación del puente H, un modo de accionamiento, donde se incrementa o decrementa la corriente en la bobina ($t_{fast}$ de la figura \ref{fig:carga-descarga-rapida}), y un modo de recirculación, donde la corriente se mantiene a un nivel casi constante, y donde solo están presentes la pérdidas resistivas causadas por $R_{ESR}$ y $R_{on}$ ($t_{slow}$ de la figura \ref{fig:carga-descarga-rapida}).

Estos modos de operación puede implementarse usando el circuto de la figura \ref{fig:circuito-control-corriente}, donde el arreglo de comparadores y flip flops permite controlar la corriente.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/circuito-control-corriente}
    \caption{Circuito de control de la corriente.}
    \label{fig:circuito-control-corriente}
\end{figure}

Como ya se ha mencionado, la razón de cambio en la corriente de un inductor está limitada por su inductancia. Esto implica que si tratamos de generar  una señal senoidal, la frecuencia máxima $F_{max}$ que podríamos producir sin distorsionarla sería:

\begin{equation}
\frac{di}{dt}_{max} = 2 \pi f_{max} A = \frac{L}{V} 
\label{eq:respuesta-frecuencia-accionamiento-1}
\end{equation}

Donde $V$ es el voltaje de alimentación del circuito. Si despejamos la frecuencia máxima tenemos:

\begin{equation}
f_{max} = \frac{L}{2 \pi V A} 
\label{eq:respuesta-frecuencia-accionamiento-2}
\end{equation} 

Podemos ver que la frecuencia máxima de la señal de salida depende de la amplitud de la misma. Esta condición  conocida como "slew rate limiting" es un fenómeno común en los amplificadores y basta con conocer los limites de operación del dispositivo para evitar esta situación.

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/fb_linearization}
        \caption{Esquema de retroalimentacion.}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/ferzas_radial}
        \caption{Equivalencia de fuerzas.}
    \end{subfigure}
    \caption{Linearización de electroimanes.}
\end{figure}

En caso de operar mas allá de los limites frecuencia-amplitud, se presentará una atenuación de magnitud:

\begin{equation}
A = \frac{L}{2 \pi V f} 
\end{equation} 

Esta atenuación coincide con la de un filtro pasabajas de primer orden, con frecuencia de corte $f_{max}$ y una caída de $20dB$ por década. Para los electroimanes presentados en \ref{sec:radial-calculo-bobina} esta respuesta corresponde a las gráficas de la figura \ref{fig:respuesta-frecuencia-electroiman} y \ref{fig:limite-frecuencia-electroiman}. 

\begin{figure}[H]
    \centering
    \includegraphics[width=.7\textwidth]{images/Capitulo_3/respuesta_frecuencia}
    \caption{Respuesta en frecuencia del circuito de accionamiento.}
    \label{fig:respuesta-frecuencia-electroiman}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=.7\textwidth]{images/Capitulo_3/limite_en_frecuencia}
    \caption{Límite en frecuencia del circuito de accionamiento.}
    \label{fig:limite-frecuencia-electroiman}
\end{figure}

Una vez ensamblado el conjunto de electroimanes resulta en el modelo de la figura \ref{fig:Modelo-3D-RMR}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/EIR_assembly}
    \caption{Modelo final del Rodamiento Magnético Radial (RMR).}
    \label{fig:Modelo-3D-RMR}
\end{figure}

\newpage

\section{Rodamiento magnético axial}

El Rodamiento Magnético Axial (RMA) sirve para ejercer fuerzas de atracción alineadas con el eje de rotación del rodamiento. Consiste en un par de electroimanes axisimétricos ubicados en los extremos del eje y una electrónica de accionamiento para activar dichos electroimanes. Estos tienen que actuar en pares para ejercer fuerzas en ambas direcciones del eje. 

\begin{figure}[h]
    \centering
    \includegraphics[width=0.625\textwidth]{images/Capitulo_3/diagrama_funcional_rma}
    \caption{Rodamiento magnético axial.}
\end{figure}

\newpage

\subsection{Electroimán}

\subsubsection{Núcleo ferromagnético}

Como se realizó en la sección \ref{sec:seleccion-somaloy} se selecciona el material Somaloy 3P [hoja de datos en anexo D] para formar el núcleo del electroimán, este material tiene unas características de: 

\begin{itemize}
\item Punto de saturación: $1.42 - 1.63 T$
\item Permeabilidad relativa: $\mu_r = 950$
\end{itemize}

Debido a que las cargas principales se encuentran en el plano de acción del RMR, no es necesario que el RMA posea la misma capacidad de carga. Entonces, con la finalidad de reducir el espacio que ocupa el RMA, se seleccionó una fuerza de $F_{min} = 10 N$. 

Como se requiere aplicar una menor fuerza es posible utilizar un rango de operación más grande. De esta manera se estableció un rango de:

$$y_{max} = 2[mm]$$
$$y_{min} = 1.0[mm]$$

Siguiendo el procedimiento desarrollado en la sección \ref{sec:diseno-elec}, y con los parámetros establecidos anteriormente, se llegó a una sección transversal de:

$$A = \frac{36 \pi}{4} = 1017[mm^2]$$

\subsubsection{Cálculo de la bobina}

Con el fin de usar la misma electrónica de accionamiento para controlar el electroimán axial, se optó por usar el mismo valor de corriente en las bobinas de $I = 2 A$. 

Retomando la sección \ref{sec:radial-calculo-bobina}, para una corriente de $2 A$ corresponde un calibre AWG $18$ [ver tabla \ref{tabla:awg-18}.

Para el cálculo del número de vueltas se utiliza la ecuación \ref{eq:vueltas-bobina} resultando en $162$ vueltas.

Con los parámetros anteriores y con la fórmula \ref{eq:area-bobina} se determina un área mínima de: $148.14 \; mm^2 \; \approx \; 148 \; mm^2$. 

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/EIA_ensamble}
    \caption{Dimensiones del Electroimán Axial.}
\end{figure}

\subsection{Simulación FEM}

Con el fin de validar los cálculos y comprobar que el núcleo no alcance su punto de saturación, se realizó una simulación de elemento finito con ayuda del software FEMM donde se obtuvieron los siguientes resultados:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/simulacion_EIA_simple}
    \caption{Simulación del electroimán axial en FEMM.}
    \label{fig:simulacion-femm-axial}
\end{figure}

En la figura \ref{fig:simulacion-femm-axial} se puede observar que el valor máximo de inducción magnética es de $0.244 T$, lo cuál está por debajo del punto de saturación del material. Nótese como las líneas de flujo magnético se curvan en los límites del entrehierro, a esto se le conoce como flujo marginal y los efectos que causa sobre la fuerza del electroimán se puede observar en la figura \ref{fig:curva-fuerza-rma}:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/simulacion_vs_modelo_axial}
    \caption{Curva Fuerza - Distancia del RMA.}
    \label{fig:curva-fuerza-rma}
\end{figure}

Cabe destacar que el modelado desarrollado en la sección \ref{sec:flujo-marginal}, el cual toma en cuenta los efectos del flujo marginal, coincide con los resultados de la simulación FEM. 

\subsection{Electrónica de accionamiento}

Como se mencionó anteriormente, se usará la misma electrónica de accionamiento que en el RMR. Sin embargo, debido a la diferencia en la inductancia de sus bobinas el sistema posee una respuesta en frecuencia distinta. 

Usando las fórmulas \ref{eq:respuesta-frecuencia-accionamiento-1} y \ref{eq:respuesta-frecuencia-accionamiento-2} podemos determinar que la respuesta en frecuencia del electroimán para diferentes valores de corriente resultan en la figura \ref{fig:respuesta-frecuencia-electroiman-RMA}.  

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/respuesta_dinamica_cp}
    \caption{Respuesta en frecuencia de la electrónica de accionamiento RMA.}
    \label{fig:respuesta-frecuencia-electroiman-RMA}
\end{figure}

\newpage

\section{Módulo de compensación de carga estática}

Ante los problemas del alto consumo de corriente en los rodamientos magnéticos activos, se propone una solución con base en los principios de funcionamiento de los rodamientos magnéticos pasivos, donde se optó por utilizar un imán permanente que deberá proveer un campo magnético base para reducir su consumo. 

El MCCE consiste en un imán permanente cuya distancia al collarín de levitación es variada mediante un servomecanismo de retracción. De esta manera, se puede ejercer una fuerza cuasiconstante con un mínimo consumo energético. Este se conforma de: imán permanente, núcleo ferromagnético, mecanismo de retracción, motor y un circuito de accionamiento. El imán permanente magnetiza todo el circuito, el núcleo guía el flujo magnético y maximiza la fuerza que el imán permanente puede ejercer. El mecanismo de retracción convierte el movimiento de rotación del motor en movimiento lineal para el imán permanente, y el circuito de accionamiento se encarga de controlar el motor. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.625\textwidth]{images/Capitulo_3/diagrama_funcional_mcce}
    \caption{Módulo de compensación para cargas estáticas.}
\end{figure}

\newpage

\subsection{Análisis de consumo energético} 

Como se indica en la sección \ref{sec:numero-polos}, el consumo en un electroimán esta dado por:

\begin{equation}
P = (\frac{R F}{K_e}) \label{eq:consumo-electroiman}
\end{equation}

En la ecuación \ref{eq:consumo-electroiman} se puede observar que el consumo depende de manera proporcionada a la fuerza aplicada por el electroimán. Si descomponemos esta fuerza en sus componentes de Fourier tenemos un término constante y la suma de las componentes armónicas a diversas frecuencias.

El término constate que usualmente corresponde al peso del objeto representa la mayor parte la fuerza, y por lo tanto, de las pérdidas. Eliminar esa componente de fuerza reduciría la corriente y el consumo energético total del rodamiento.

Usar un imán permanente con fuerza $F_{ip}$ como en el caso de un rodamiento pasivo, reduce las pérdidas del sistema a un valor de: 

\begin{equation}
|\frac{R (F_L - F_{ip})}{K}|
\end{equation}

El problema consiste en decidir de antemano el valor de la carga estática para igualar los términos $F_l$ y $F_{ip}$, y así reducir las pérdidas. 

Es posible variar la fuerza que ejerce un imán permanente variando la distancia entre este y el objetivo. Si usamos un imán capaz de ejercer un fuerza $F_ip$ mucho más grande de la requerida y la montamos sobre una plataforma móvil (mecanismo de retracción), podríamos ajustar la fuerza hasta llevar las pérdidas a $0$.  

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/iman_permanente}
        \caption{Imán permanente.}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/mecanismo_retraccion}
        \caption{Mecanismo de retracción.}
    \end{subfigure}
\end{figure}

\subsection{Imán Permanente y Núcleo Ferromagnético}

La fuerza que ejerce un imán permanente puede modelarse mediante la fórmula:

\begin{equation}
	F = \frac{B_r^2}{2 \mu_0 (1 + (\frac{\mu_m}{\mu_0})(\frac{A_m}{A_g})(\frac{g}{l_m}))^2}[\frac{A_m + 2A_g}{2A_g}]
	\label{eq:fuerza-iman-permanente}
\end{equation}

Esta fuerza depende tanto de la geometría del imán permanente como del material del que esté compuesto, y donde $H_c$, $B_r$ y $A_m$ son los términos dominantes.  

Es nuestro objetivo diseñar un conjunto imán-núcleo lo más pequeño posible, y debido a que las dimensiones y composición de los imanes permanentes están determinadas por el fabricante nos limitamos a seleccionar el imán más pequeño disponible. Este imán deberá generar al menos una fuerza $F_{min}$.   

Finalmente las dimensiones del núcleo se determinan de tal manera que el imán permanente pueda instalarse dentro de éste.  

Para el diseño del imán tenemos el siguiente proceso:

\begin{enumerate}
\item Especificar las condiciones de operación $F_{min}$, $y_{min}$. 
\item Seleccionar el material del imán permanente con el $H_c$, $B_r$ más altos disponibles. 
\item Seleccionar las dimensiones del imán permanente según disponibilidad del fabricante. 
\item Dimensionar el núcleo guía de manera que acomode correctamente el imán permanente. 
\item Usar la fórmula \ref{eq:fuerza-iman-permanente} para calcular la fuerza $F_{ip}$. 
\item Si la fuerza $F_{min} > F_{ip}$ incrementar las dimensión y repetir los pasos.
\end{enumerate}

\subsubsection{Selección del imán permanente}

Entre las diferentes composiciones de imanes permanentes destacan aquellas de Neodimio-Hierro-Boro, comúnmente conocidas como imanes de neodimio. Los valores más altos $H_c$ y  $B_r$ son alcanzados por los imanes de grado $N52$, con valores de $B_r = 1400mT$ y $H_c=796kA/m$ [véase anexo B]. 

Siguiendo el procedimiento anterior para generar una fuerza $F_{min}$ de al menos $50 N$ resultó en un imán cúbico de 10 mm por lado \cite{cite_s21_2017_first4magnets}.

Así pues el conjunto Imán Permanente - Núcleo Ferromagnético queda representado por la figura \ref{fig:conjunto-ip-nucleo}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/IP_ensamble}
    \caption{Conjunto Imán permanente - Núcleo Ferromagnético.}
    \label{fig:conjunto-ip-nucleo}
\end{figure}

\subsubsection{Simulación FEM}

Así como se hizo en la sección \ref{sec:simulacion-fem-electroiman}, podemos validar nuestro modelo mediante una simulación FEM, lo que resulta en la siguiente curva característica de la figura \ref{fig:iman-permanente-curva}.

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=0.8\textwidth]{images/Capitulo_3/fuerza_iman_permanente}
\caption{Curva característica del imán permanente.}
\label{fig:iman-permanente-curva}
\end{center}
\end{figure}

\subsection{Mecanismo de retracción}

El servomecanismo que utilizará el imán permanente para su desplazamiento consiste en un par de rieles que se montarán sobre la base del motorreductor y la base del imán permanente; esta última será la que se desplazará a lo largo de los rieles. 

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/Mecanismo_ensamble}
    \caption{Configuración final MCCE.}
    \label{fig:configuracion-final-MCCE}
\end{figure}

Para generar dicho desplazamiento se utiliza un mecanismo tornillo-tuerca, conocido también como husillo-tuerca. Es un mecanismo de transformación circular a lineal compuesto por una tuerca alojada en un eje roscado (tornillo).

\begin{figure}[H]
\centering
	\includegraphics[scale=.3]{images/Capitulo_3/Tornillo}
	\caption{\textit{Mecanismo Tornillo Tuerca \citep{cite_17}.}}
\end{figure}

\newpage

Este mecanismo se puede plantear de dos formas: un tornillo de posición fija que al girar provoca el desplazamiento de la tuerca, o una tuerca fija que produce el desplazamiento del tornillo cuando este gira. En este caso, utilizaremos el tornillo de posición fija y la tuerca consistirá en la base del imán permanente. 
Este tipo de mecanismos son utilizados en diferentes aplicaciones y son ideales como mecanismos de desplazamiento, debido en parte a su gran precisión y al reducido espacio que requieren. 
El avance depende de dos factores \citep{cite_18} :

\begin{itemize}
\item La velocidad de giro del elemento motriz.
\item El paso de la rosca del tornillo. Cuanto mayor sea el paso, mayor será la velocidad de avance.
\end{itemize}

\subsubsection{Selecci\'on de la Rosca}

El mecanismo tornillo-tuerca presenta una ventaja muy importante respecto a otros sistemas de conversión de movimiento circular en longitudinal: por cada vuelta del tornillo la tuerca solamente avanza la distancia correspondiente al paso de la rosca. 

En general el avance del tornillo viene dado por:

\begin{equation}
A = p * e
\end{equation}

Donde $p$ es el paso de la rosca y $e$ corresponde al número de entradas del tornillo. 

Con el fin de reducir la fuerza producida por el imán permanente hasta un valor mínimo, se necesita un recorrido de 4 mm respecto a la distancia mínima entre éste y el collarín de levitación. Con estas consideraciones se determinó el uso de una rosca métrica M 2 x 0,4, que corresponde a un diámetro nominal de 2 mm, paso de rosca de 0.4 mm y una entrada [véase anexo A], con lo que únicamente requeriríamos generar 10 vueltas del motorreductor para el desplazamiento máximo de 4 mm. 

\newpage

\begin{figure}[H]
\centering
		\includegraphics[width=0.5\textwidth]{images/Capitulo_3/Rosca}
		\caption{\textit{Especificaciones de la rosca M 2 x 0.4 \citep{cite_19}.}}
\end{figure}

Especificaciones \citep{cite_19}:

\begin{itemize}
\item Diámetro nominal: $D$ = $d$ = $2 mm$
\item Paso: $P$ = $0.4 mm$
\item Altura: $H$ = $\frac{raiz*3}{2}$*$P$ = 0.866025*$P$ = $0.35 mm$
\item Profundidad portante de flancos: $H1$ = ($D$ - $D_1$)/2 = 5/8*$H$ = 0.541266*$P$ = $0.22 mm$
\item Profundidad de rosca: $h_3$ = ($d$ - $d_3$)/2 = 17/24*$H$ = 0.613435*$P$ = $0.25 mm$
\item Diámetro de francos: $D2$ = $d_2$ = $d$ - 3/4*$H$ = $d$ - 0.649519*$P$ = $1.74 mm$
\item Radio fondo de rosca: $R$ = $H$/6 = 0.144338*$P$ = $0.058 mm$
\end{itemize}

Rosca Interior (Tuerca):
\begin{itemize}
\item $D_1$ = $d_2$ - 2*($H$/2 - $H$/4) = d - 2*$H_1$ = $d$ - 1.082532*$P$ = $1.57 mm$
\end{itemize}

Rosca Exterior (Tornillo):
\begin{itemize}
\item Diámetro del núcleo: $d_3$ = $d_2$ - 2*($H$/2 - $H$/6) = $d$ - 1.226869*$P$ = $1.51 mm$
\item Diámetro del núcleo: $d_3$ = $d_1$ - $H$/6 = $1.51 mm$ (según la norma DIN ISO 724)
\end{itemize}

\newpage

\subsubsection{Motorreductor} \label{sec:Motorreductor}

Para el motorreductor se seleccionó el modelo \textbf{LP 6V 1000:1} de Pololu \cite{cite_s19_2017_polulu}. Este motorreductor miniatura de alto par tiene una caja de cambios de $1000: 1$, por lo que es una gran opción para aplicaciones que requieren un control preciso a velocidades muy bajas. Estas unidades tienen un eje de salida en forma de D de $3 mm$ de diámetro.

Este motorreductor posee unas especificaciones clave de $14 RPM @ 6 V$ y $40 mA$ al vacío, $5 kg-cm$ de par y $0.36 A$ en bloqueo.

Estos motores están diseñados para poder operar a $6 V$, aunque en general, estos tipos de motores pueden funcionar a voltajes por encima y por debajo de este voltaje nominal, por lo que deberían funcionar cómodamente en el rango de $3 - 9 V$. 
 
    \begin{figure}[H]
    \centering
        \includegraphics[width=0.3\textwidth]{images/Capitulo_3/motoreductor}
        \caption{Motorreductor.}
    \end{figure}
    
\newpage

\subsection{Accionamiento}

Como se indica en la sección \ref{sec:Motorreductor}, la corriente máxima que demanda el motor es de $360 mA$. Como queremos mover el motor en ambas direcciones es necesario un circuito de puente H para su accionamiento. Para ello se seleccionó el circuito integrado L293 \cite{cite_s18_2017_l293}. 

Este controlador de motor cuenta con dos puentes H que se pueden utilizar para el control bidireccional de dos motores de corriente continua o para controlar un solo motor de pasos. Funciona a partir de $4.5$ a $36 V$ y puede entregar una corriente pico de $1 A$ por canal. La conexión de este circuito integrado se muestra en la figura \ref{fig:puente-h-l293}.

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.7\textwidth]{images/Capitulo_3/CircuitoL293}
    \caption{Circuito Puente H L293.}
    \label{fig:puente-h-l293}
\end{figure}

\newpage

\subsection{Modelado electromecánico}

Para el modelado del MCCE comenzamos por establecer las ecuaciones \ref{eq:motor-MCCE-1}, \ref{eq:motor-MCCE-2} y \ref{eq:motor-MCCE-3} correspondientes al motor de DC, donde la entrada del sistema es el voltaje de alimentación $V{in}$ y como salidas tenemos el par de accionamiento $T_1$.

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=8cm]{images/Capitulo_2/modelo_electromecanico_mcce}
\caption{Modelo electrodinámico del MCCE.}
\end{center}
\end{figure}

Comenzamos con la malla del motor que describe la razón de cambio en la corriente:

\begin{equation}
 V_{in} = Ri + L \frac{d}{dt}i + V_{E}  
 \label{eq:motor-MCCE-1}	
\end{equation}

Seguimos con el par torsor de salida que es proporcional a la corriente del motor:

\begin{equation}
 T = K_t i 
 \label{eq:motor-MCCE-2}	
\end{equation}

Y finalmente el voltaje contraelectromotriz, el cual es proporcional a la velocidad del motor:
 
\begin{equation}
 V_{E} = K_v \omega 
  \label{eq:motor-MCCE-3}	
\end{equation}

A continuación modelamos la parte mecánica para relacionar el par del motor con la fuerza de elevación del mecanismo. En los engranajes del motor tenemos una relación de engranes de $N_1/N_2$, entonces las velocidades angulares serán:

\begin{equation}
 \omega_2 = \frac{N_2}{N_1} \omega_1
\end{equation}

Y la relación de los pares torsores será: 

\begin{equation}
 T_2 = \frac{N_1}{N_2} T_1
\end{equation}

Finalmente, se relaciona el par torsor con la fuerza de elevación y descenso del tornillo. Debido a la acción de la fricción se tiene una ecuación para el descenso y otra para la elevación. Para el par de elevación tenemos:

\begin{equation}
    T = \frac{F \cdot d_m}{2} \cdot \frac{\rho + (\pi \cdot \mu \cdot d_m \cdot \sec \theta)}{(\pi \cdot d_m) - (\mu \cdot \rho \cdot  \sec \theta)} 
\end{equation}

Donde: \\
    $F$ = Valor de la carga\\
    $\rho$ = Paso del tornillo \\
    $d_m$ = Diámetro medio del tornillo\\
    $\mu$ = Coeficiente de rozamiento la rosca y el tornillo \\
    $\theta$ = $\frac{Angulo;de;la;rosca}{2}$\\

Y para el par de descenso tenemos:

\begin{equation}
    T= \frac{F \cdot d_m}{2} \cdot \frac{\pi \cdot \mu \cdot d_m \cdot \sec \theta - \rho}{\pi \cdot d_m + \mu \cdot \rho \cdot \sec \theta}
\end{equation}

Todas estas ecuaciones se introducen en el modelo de \textbf{Simulink} que queda representado en la figura \ref{fig:modelo-simulink-mcce}.

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=\textwidth]{images/Capitulo_2/simulink_mcce}
\caption{Modelo en \textbf{Simulink} del MCCE.}
\label{fig:modelo-simulink-mcce}
\end{center}
\end{figure}

\newpage

\section{Sensor de distancia capacitivo}

El sensor de distancia capacitivo sirve para medir la posición del rotor dentro del rodamiento. Este sensor consiste en un electrodo y un circuito de acondicionamiento. 

El electrodo proyecta un campo eléctrico al frente de este y la interacción del rotor con este campo causa cambios en la capacitancia que son convertidos a una señal de frecuencia variable por el circuito de acondicionamiento.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.625\textwidth]{images/Capitulo_3/diagrama_funcional_sdc}
    \caption{Sensor de distancia capacitivo (SDC).}
\end{figure}

Este sensor presenta ventajas como: 

\begin{enumerate}
	\item Un rango de operación de $0.5 mm$ a $2mm$.
	\item Medición sin contacto. 
	\item Inmunidad al ruido de acoplamiento magnético causado por los electroimanes.
	\item Rápida respuesta.
\end{enumerate}

Para el sensor se utilizó un diseño similar al presentado en \citep{cite_14}, con la diferencia de que el circuito de acondicionamiento se encuentra embebido dentro de la  carcasa del electrodo, esto con el fin de eliminar los efectos de la capacitancia parásita producidos e introducidos por el cable coaxial, además dado que la carcasa actúa como blindaje se previenen interferencias externa de tipo eléctrico.

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
     \centering
        \includegraphics[width=.5\textwidth]{images/Capitulo_3/Sensor-ilustrativo-2}
        \caption{Sensor sin blindaje activo.}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.45\textwidth}
     \centering
        \includegraphics[width=.5\textwidth]{images/Capitulo_3/Sensor-ilustrativo-1}
        \caption{Sensor con blindaje activo.}
    \end{subfigure}
\end{figure}

\newpage

\subsection{Electrodos}

El electrodo consiste en una placa frontal ($S_1$), un conductor cilíndrico externo que actúa como blindaje pasivo del sistema ($S_3$) y un conductor cilíndrico interno ($S_2$) que actúa como blindaje activo que reduce los efectos de la capacitancia parásita dentro del electrodo. Finalmente un conductor recubierto en el centro conecta el área sensitiva de la placa frontal con el circuito de acondicionamiento.

La geometría del electrodo determina la capacitancia y, por lo tanto, la sensitividad del dispositivo. Modelar la relación entre la geometría del sensor y su capacitancia requiere solucionar la ecuación: 

\begin{equation}
\nabla^2 V = 0
\end{equation}

Las soluciones analíticas de esta ecuación para la geometría usada en este sensor está fuera del alcance de este trabajo, en su lugar usando el software de simulación electrostática FEMM encontramos soluciones numéricas y de esta manera determinamos la capacitancia del electrodo, así como se realizó en \citep{cite_s15_2017_snoa928}. 

El electrodo del SCD posee una geometría como se muestra en la figura \ref{fig:geometria-sdc}.

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[height=6cm]{images/Capitulo_3/cdc_geometria_top}
        \caption{Vista frontal.}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.45\textwidth}
    	\centering
        \includegraphics[height=6cm]{images/Capitulo_3/cdc_geometria_side}
        \caption{Vista lateral.}
    \end{subfigure}
    \caption{Geometría del SDC}
    \label{fig:geometria-sdc}
\end{figure}

Se define $A_3$ como el área del anillo externo $S_3$ y $A_1$ como el área de la placa frontal $S_1$. Y a la relación entre estos dos como $\alpha$ de manera que: 

\begin{equation}
\alpha = \frac{A_1}{A_3}
\end{equation}

Si realizamos una simulación variando los parámetros $A_1$ y $A_3$, podemos observar que entre más grande sea el área del electrodo más grande será la capacitancia. Este comportamiento concuerda con la ecuación del capacitor de placas paralelas \ref{eq:capacitor-placas-paralelas}.

\begin{equation}
C = \frac{\epsilon A}{d}
\label{eq:capacitor-placas-paralelas}
\end{equation} 

Suponiendo un objetivo de sensado con superficie plana y un área total constante $A_t$ el valor de $\alpha$ que maximiza la capacitancia del sensor es igual a $1$, en otras palabras, áreas iguales entre la placa frontal y el anillo exterior \cite{cite_s15_2017_snoa928}.

Sin embargo el rotor es un objetivo con una superficie curva por lo que hay que tener en cuenta los efectos que pueda tener en la sensitividad del sensor. En la figura \ref{fig:grafica_desfasamiento_capacitancia} se puede observar que bajo diferentes curvaturas el valor óptimo de $\alpha$ se desfasa. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{images/Capitulo_3/capacitancia_alpha}
    \caption{Desfasamiento de punto óptimo en el SDC.}
    \label{fig:grafica_desfasamiento_capacitancia}
\end{figure}

Entonces para calcular el punto óptimo es necesario realizar un conjunto de simulaciones variando $\alpha$, contemplando la curvatura real del rotor. Esto se realiza mediante un script de \textbf{Matlab} capaz de generar diferentes configuraciones del electrodo y ejecutar una simulación en FEMM para calcular la capacitancia dentro de cada configuración. Este conjunto de datos es recolectado y graficado para determinar el punto óptimo como se muestra en la figura \ref{fig:grafica_capacitancia_optima}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{images/Capitulo_3/punto_optimo_alpha}
    \caption{Configuración óptima del SDC.}
    \label{fig:grafica_capacitancia_optima}
\end{figure}

Finalmente con el máximo ubicado en $\alpha = 0.274$ que se obtiene de la figura \ref{fig:grafica_capacitancia_optima} se ejecuta otro script que varía la distancia entre el objetivo y el sensor para obtener la curva característica mostrada en la figura \ref{fig:sensor_caracterizacion_final_radial}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/sensor_caracterizacion_final_radial}
    \caption{Curva característica del SDC.}
    \label{fig:sensor_caracterizacion_final_radial}
\end{figure}

\newpage

\subsection{Circuito de acondicionamiento}

Una vez conocidos el rango de capacitancias es posible diseñar un circuito que se encargará de convertir la capacitancia del electrodo en una señal cuadrada con una frecuencia variable, seguido de la conversión de la señal cuadrada a una señal diferencial para aumentar su inmunidad al ruido. Este circuito además se encarga de aplicar un voltaje al blindaje activo del electrodo hasta llevarlo al mismo potencial eléctrico que la placa frontal con el fin de reducir los efectos de la capactitancia parásita. 

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/Circuito_acondicionamiento}
    \caption{Circuito de acondicionamiento.}
\end{figure}

\newpage


La conversión es realizada por un circuito integrado 555 en configuración de multivibrador astable, usando el electrodo como capacitor de temporización. Este  circuito debe de ser la versión CMOS del 555 que presenta menores corrientes de polarización, las cuales podrían alterar la frecuencia de oscilación.

El potencial del blindaje activo es controlado por un amplificador operacional en modo seguidor de voltaje, el cual tiene una salida idéntica al voltaje de su entrada además de una alta impedancia de entrada con el fin de no alterar las mediciones de frecuencia. Además la conversión de señal simple a señal balanceada es realizada por un driver diferencial.

Finalmente el circuito queda dentro de una caja metálica a fin de operar como jaula de Faraday y aislarlo del posible ruido eléctrico en el ambiente como se muestra en la figura \ref{fig:explosionado-sdc}. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/sdc_ensamble}
    \caption{Explosionado del SDC.}
    \label{fig:explosionado-sdc}
\end{figure}

\newpage

\section{Collarín de levitación}

Como se mencionó anteriormente, con el propósito de lograr la levitación del eje sin importar el material del que esté fabricado, se propuso el uso de un collarín que sostenga el eje dentro del rodamiento y que cuente con una sección de material ferromagnético, de manera que sea esta la que interactúe con los electroimanes de los rodamientos activos y con el imán permanente. 

Este collarín se compone principalmente de cuatro partes: el cuerpo principal, el anillo ferromagnético para el RMR (núcleo radial) y el MCCE (núcleo pasivo), el disco de detección y el disco ferromagnético para el RMA (núcleo axial). 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.625\textwidth]{images/Capitulo_3/diagrama_funcional_cl}
    \caption{Diagrama funcional del collarín de levitación.}
\end{figure}

\newpage

\subsection{Material del anillo y disco ferromagético}

Como se realizó en la sección \ref{sec:seleccion-somaloy}, se selecciona el material Somaloy 3P [hoja de datos en anexo D] para formar el anillo y núcleo ferromagnéticos. Este material posee las siguientes características: 

\begin{itemize}
\item Punto de saturación: $1.42 - 1.63 T$
\item Permeabilidad relativa: $\mu_r = 950$
\end{itemize}

\subsection{Material del cuerpo principal}

El cuerpo principal se usa como medio de acople entre el collarín y el eje, además de servir como soporte para el resto de los componentes. Sin embargo, el cuerpo del collarín cuenta con algunas restricciones en cuanto al material del que esté fabricado:

\begin{itemize}
\item El material no puede ser metálico para evitar las corrientes parásitas (corrientes de Foucault).
\item Debe ser lo suficientemente rígido para evitar deformarse por las fuerzas que actúen sobre él. 
\item Debe ser lo suficientemente liviano para no exceder la fuerza máxima que puede generar los electroimanes y el imán permanente.  
\item Además debe contar con una permitividad eléctrica ($\epsilon$) alta para mejorar su detectabilidad antes el SDC. 
\end{itemize}

Una de las mejores alternativas que tenemos y que pueden cumplir con estas características son los polímeros. Los plásticos en ingeniería han tenido una gran aceptación debido a sus características específicas. Poseen buenas propiedades mecánicas como una gran resistencia al impacto y a la fatiga, bajo coeficiente de fricción, resistencia al desgaste y al ataque por sustancias químicas, su bajo costo en comparación con la mayoría de los metales además de ser más livianos y más fáciles de maquinar. 

Uno de los plásticos de ingeniería más utilizados es el Nylamid, de la familia de las Poliamidas (PA). Debido a sus propiedades mecánicas y eléctricas, a su amplia variedad de presentaciones y medidas y a su relativamente bajo costo se ha utilizado mucho para la fabricación de piezas en el ramo industrial sustituyendo materiales como el acero, bronce, aluminio, madera y cerámica. 

Sin embargo, para tener una mayor certeza en cuanto al material seleccionado se dispuso a utilizar el método gráfico para la selección de materiales apoyándonos en el software CES EduPack. Este método utiliza mapas de materiales, también denominados diagramas de Ashby. En estos diagramas se puede hacer una aproximación del material más adecuado con base en las propiedades más importantes que debe poseer el componente. Agrupan los materiales en diferentes familias, formando grupos cerrados y relacionando en pares ciertas propiedades de los materiales. 

Para nuestro caso compararemos dos propiedades relacionadas a las restricciones que se establecieron para el material:

\begin{itemize}
\item Módulo de Young.
\item Densidad. 
\end{itemize}

Como sabemos, el Módulo de Elasticidad, también llamado Módulo de Young, es un parámetro característico de un material que indica la relación que existe entre la tensión y la correspondiente deformación unitaria en un material sometido a un esfuerzo, y que está por debajo del límite de elasticidad del material. El módulo de Young indica la rigidez del material, es decir, la oposición de este a ser deformado. Cuanto más rígido sea el material, mayor es su módulo de elasticidad. 

Para el análisis del material con el software CES EduPack compararemos únicamente polímeros relacionando el Módulo de Young y la densidad, obteniendo un total de 738 materiales disponibles:

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/Material1}
    \caption{Diagrama total de materiales (Módulo de Young vs. Densidad).}
\end{figure}

Para poder reducir el número de materiales desplegados y facilitar la selección podemos definir algunos límites dentro de los parámetros que se establecieron. En este caso, nos basaremos en los valores de densidad y módulo de Young de las poliamidas que, como ya vimos, son uno de los plásticos de ingeniería más utilizados, principalmente para la fabricación de componentes mecánicos como rodamientos y engranes. 

Esto nos ayuda a establecer un parámetro de selección a falta de contar con datos más específicos en cuanto a las condiciones de operación más allá de las restricciones que se establecieron anteriormente. Estos datos pueden ser obtenidos dentro de la biblioteca de materiales que contiene el software. Sin embargo, debido a la gran cantidad de compuestos y variantes que presenta este material no puede establecerse un valor exacto, por lo que se proponen unos valores promedio de:

\begin{itemize}
\item 2 GPa para el Módulo de Young.
\item 1.4 $g/cm^3$ para la densidad. 
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/Material2}
    \caption{Límite máximo para el módulo de Young.}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/Material3}
    \caption{Límite máximo para la densidad.}
\end{figure}

Como podemos notar, las restricciones en cuanto a la familia de materiales y los valores de densidad y módulo de Young redujeron de manera significativa la cantidad de materiales de selección, tratándose en su mayoría de ABS, PET y Polipropilenos. 

El siguiente parámetro que se consideró fue la permitividad eléctrica del material, que como se estableció en las especificaciones, se prefiere optar por materiales con un valor $\epsilon$ mayor. Se definió una permitividad relativa mínima de $3.5$, el cual corresponde al valor de la permitividad relativa del Nylon \cite{cite_s20_2017_goodfellow}. 

Con este último parámetro se obtuvo el siguiente diagrama, con un total de 91 materiales de selección posibles de los 738 que se tenían originalmente: 

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/Material4}
    \caption{Límite máximo para el costo del material.}
\end{figure}

Al consultar individualmente las propiedades de los materiales restantes se consiguió encontrar un material que puede utilizarse para la fabricación del collarín de levitación, debido a sus propiedades y a las aplicaciones para las que normalmente se utiliza. Este material es el Polioximetileno (POM), también conocido como Acetal [véase anexo E]:

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/Capitulo_3/Material5}
    \caption{Identificación del material Acetal (POM).}
\end{figure}

El Acetal se caracteriza por su bajo coeficiente de fricción, su resistencia al desgaste y buena resistencia a la abrasión, así como facilidad de maquinado. Tiene alta resistencia a impactos y a la humedad, provee alta resistencia y rigidez en combinación con su excelente estabilidad dimensional y elevado módulo de elasticidad.
Se utiliza principalmente para la fabricación de engranes, cojinetes, dispositivos de sujeción, ruedas, rodillos, soportes estructurales, etc \citep{cite_s17_2017_prospector_acetal}.

Debido a sus características y aplicaciones se consideró el Acetal (POM) como el material del que se constituiría el collarín de levitación ya que cumple con las propiedades necesarias para cubrir las especificaciones que se plantearon inicialmente. 

La segunda pieza que se debe considerar es el disco posterior. Este disco debe su forma a que se utiliza como superficie para medir la posición del rotor en la dirección axial con ayuda del sensor acoplado al RMA. A modo de simplificación se optó porque dicho disco se componga del mismo material que el cuerpo principal del collarín [Acetal (POM)].

El ensamble final de los componentes descritos anteriormente se muestran en la figura \ref{fig:collarin-ensamble}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{images/Capitulo_3/funda_asm}
    \caption{Ensamble final del collarín de levitación.}
    \label{fig:collarin-ensamble}
\end{figure}

\newpage

\section{Controlador} \label{sec:Controlador-Capitulo-2} 

Todos los rodamientos magnéticos deben poseer un sistema de control que ejecute las correcciones necesarias para mantener el eje en levitación. El sistema de control de nuestra propuesta consiste en un controlador retroalimentado en espacio de estados y un observador para determinar el estado del sistema. 

El procedimiento realizado a continuación permite obtener un modelo dinámico del eje, linealizar la representación del sistema, especificar la respuesta deseada, calcular las ganancias del controlador-observador en modo continuo y discretizar el conjunto controlador-observador. Además, mediante el control calendarizado se compensarán los efectos de controlar un sistema no lineal usando una aproximación linealizada. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.625\textwidth]{images/Capitulo_3/diagrama_funcional_controlador}
    \caption{Diagrama funcional del controlador.}
\end{figure}

\newpage

\subsection{Modelo dinámico del eje} \label{sec:modelo-dinamico}

El primer paso consiste en obtener el modelo dinámico del sistema. En la figura \ref{fig:diagrama-cl-eje} podemos observar las fuerzas que actúan sobre el eje $F_a$, $F_r$, $F_p$ correspondientes al EIA, EIR e IP respectivamente. 

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=\textwidth]{images/Capitulo_2/diagrama_cuerpo_libre_rotor}
\caption{Diagrama de cuerpo libre del eje.}
\label{fig:diagrama-cl-eje}
\end{center}
\end{figure}

El EIR ejerce fuerzas en el plano $Y-Z$, mientras el EIA y el IP ejercen fuerzas en los ejes $X$ y $Z$ respectivamente. Estas fuerzas están representadas en la ecuación \ref{eq:fuerzas-rotor}. 

\begin{equation}
	\vec{F}_{r} = \begin{pmatrix}
	0\\
	F_{ry}\\
	F_{rz}\\
	\end{pmatrix}
	\vec{F}_a = \begin{pmatrix}
	F_{ax}\\
	0\\
	0\\
	\end{pmatrix}
	\vec{F}_p = \begin{pmatrix}
	0\\
	0\\
	F_{pz}\\
	\end{pmatrix}
	\label{eq:fuerzas-rotor}
\end{equation}

Los respectivos momentos generados por el EIR y el IP son:

\begin{equation}
	\vec{M}_r = \vec{r}_r \times \vec{F}_r 
\end{equation}

\begin{equation}
	\vec{M}_p = \vec{r}_p \times \vec{F}_p 
\end{equation}

Si consideramos la acción conjunta de ambos EIA como una sola fuerza, entonces el momento generado por estos será de la forma:

\begin{equation}
	\vec{M}_A = \vec{r}_a \times abs(\vec{F}_a)
\end{equation}

Para establecer la ecuación de suma de momentos es necesario determinar la matriz de inercia para el eje representado por la figura \ref{fig:inercia-rotor-diagrama}. 

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=12cm]{images/Capitulo_3/diagrama_momentos}
\caption{Diagrama de momentos de inercia.}
\label{fig:inercia-rotor-diagrama}
\end{center}
\end{figure}

En la figura \ref{fig:inercia-rotor-diagrama} podemos identificar tres elementos correspondientes al eje y al par de collarines. Podemos calcular la matriz de inercia respecto a los ejes principales aplicando el teorema de ejes paralelos, lo que resulta en la ecuación \ref{eq:matriz-inercia-paralelos}. 

\begin{equation}
	[I] = \begin{pmatrix}
	I_{xxa} + 2I_{xxb}  & 0 & 0\\
	0 & I_{yya} + 2I_{yyb} + 2m_b r_b^2 & 0\\
	0 & 0 & I_{zza}+2I_{zzb}+ 2 m_b r_b^2
	\end{pmatrix}
	\label{eq:matriz-inercia-paralelos}
\end{equation}

Debido a que el conjunto eje-collarín posee simetría radial respecto al eje $X$, los momentos principales $Iyy$ e $Izz$ son iguales, lo que permite reducir la ecuación \ref{eq:matriz-inercia-paralelos} a la forma:  

\begin{equation}
	[I] = \begin{pmatrix}
	I_{xx}  & 0 & 0\\
	0 & I_{\rho}  & 0\\
	0 & 0 & I_{\rho}
	\end{pmatrix}
	\label{eq:matriz-inercia-reducida}
\end{equation}

Como indica la sección \ref{sec:angulos-euler} es necesario definir un marco de referencia móvil para establecer las ecuaciones dinámica. Como el cuerpo es axisimétrico solo son necesarias dos rotaciones para describir su orientación, siempre y cuando permitamos la libre rotación (spin) dentro de este nuevo marco de referencia. Estas corresponden a las primeras dos rotaciones extrínsecas Tait-Bryan $z-y-x$ como se muestra en la figura \ref{fig:angulos-tb-2}. 

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=8cm]{images/Capitulo_2/angulos_euler_rotor}
\caption{Marco de referencia móvil.}
\label{fig:angulos-tb-2}
\end{center}
\end{figure}

Podemos definir este nuevo marco de referencia como la transformación $T_O^B$ como se muestra en la ecuación:

\begin{equation}
	T_O^B (\theta,\psi)= {T_A}^B (\theta) {T_A}^O (\psi) 	
	\label{eq:transformada-marco-movil}
\end{equation}

Donde las matrices de rotación ${T_A}^B (\theta)$ y ${T_A}^O (\psi)$ están definidas en la ecuación \ref{eq:matrices-angulos-euler}, y como el eje gira dentro del eje $X$ del marco de referencia móvil con una velocidad $\omega_\phi$, la velocidad angular $\omega$ del eje estará descrita por:

\begin{equation}
  \omega = \omega_\phi + \Omega
\end{equation}

Donde $\Omega$ es la velocidad angular del marco de referencia móvil. Calcular el producto cruz de la ecuación \ref{eq:derivada-inercia-coriolis} requiere que ambos vectores estén en el mismo marco de referencia. Por lo que es necesario transformar los vectores de fuerza al marco móvil mediante la matriz de transformación $T^{B}_O$.

La ecuación \ref{eq:angulos-intrinsecos-marco-movil} relaciona la variación de los ángulos intrínsecos $\phi$ y $\theta$ con la velocidad angular del marco de referencia móvil respecto al marco fijo $\Omega$. 

\begin{equation}
	\begin{pmatrix}
	\dot{\theta}\\
	\dot{\psi}
	\end{pmatrix} = \begin{pmatrix}
	0 & cos(\phi) & -sin(\phi)\\
	0 & - sin(\phi)sec(\theta) & cos(\phi)sec(\theta)
	\end{pmatrix} \begin{pmatrix}
	\Omega_x\\
	\Omega_y\\
	\Omega_z
	\end{pmatrix}
	\label{eq:angulos-intrinsecos-marco-movil}
\end{equation}

Sustituyendo los términos descritos en la sección \ref{sec:modelo-dinamico}, en la ecuación \ref{eq:derivada-inercia-coriolis} se obtiene las ecuaciones usado en el script \ref{ap:sistema-ecuaciones-no-lineal}. 

Estas ecuaciones se introducen dentro del modelo de \textbf{Simulink} mostrado en la figura \ref{fig:modelo-sistema} para realizar la simulación.   

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/modelo_simulink_sistema}
\caption{Modelo del sistema.}
\label{fig:modelo-sistema}
\end{center}
\end{figure}

\newpage

\subsection{Linealización}

Podemos observar que este sistema de ecuaciones es no lineal, así que tenemos que linealizarlo para convertirlo en la forma canónica de espacio de estados, y aplicar las técnicas de control descritas en la sección \ref{sec:control} mediante las siguientes fórmulas \ref{eq:control:jacobiano}: 


%FORMULAS

Lo que resulta en el sistema lineal de la ecuación \ref{ap:sistema-ecuaciones-lineales}:


%MATRICES

\begin{equation}
	A = \begin{pmatrix}
	0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
	0 & 0 & 0 & 0 & 0 & 0 & 0 & A_{8,8} & 0 & A_{8,10}\\
	0 & 0 & 0 & 0 & 0 & 0 & A_{9,7} & A_{9,8} & 0 & A_{9,10} \\
	0 & 0 & 0 & 0 & 0 & 0 & A_{10,7} & 0 & A_{10,9} & 0 \\
	\end{pmatrix}
	\label{eq:matrices_modelo_linearizado_a}
\end{equation}
$$
A_{8,8} = (x_{10} sin(x_8)) / cos(x_8)^2
$$
$$
A_{8,10} = 1/cos(x_8)
$$
$$
A_{9,7} = -(R_r u_1 cos(x_7) sin(x_8) - R_r u_3 cos(x_7) sin(x_8)) / I_0
$$
$$
A_{9,8} = (R_r (u_2 sin(x_8) - u_1 cos(x_8) sin(x_7)) - R_r (u_4 sin(x_8) - u_3 cos(x_8) sin(x_7)))/I_0
$$
$$
A_{9,10} = -(I_\rho \omega_s) / I_0
$$
$$
A_{10,7} = -(R_r u_1 sin(x_7) - R_r u_3 sin(x_7))/I_0
$$
$$
A_{10,9} = (I_\rho \omega_s) / I_0
$$


\begin{equation}
	A = \begin{pmatrix}
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 1/m \\
	1/m & 0 & 1/m & 0 & 0 \\
	0 & 1/m & 0 & 1/m & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 \\
	B_{9,1} & B_{9,2} & B_{9,3} & B_{9,4} & 0 \\
	B_{10,1} & 0 & B_{10,3} & 0 & 0\\
	\end{pmatrix}
	\label{eq:matrices_modelo_linearizado_b}
\end{equation}

$$B_{9,1} = -(R_r sin(x_7) sin(x_8))/I_0 $$ 
$$B_{9,2} =  -(R_r cos(x_8))/I_0 $$
$$B_{9,3} = (R_r sin(x_7) sin(x_8))/I_0 $$
$$B_{9,4} = (R_r cos(x_8))/I_0 $$
$$B_{10,1} = (R_r cos(x_7))/I_0 $$
$$B_{10,3} = -(R_r cos(x_7))/I_0 $$


\subsection{Controlador}

Con el fin de estabilizar el sistema descrito en la ecuación \textbf{[sistema linealizado]} utilizamos el esquema de control retroalimentado presentado en la sección \ref{sec:control-retroalimentado}. 

Se selecciona un conjunto de polos para el nuevo sistema y se utiliza el script de \textbf{Matlab} \ref{ap:ganancias-control} para calcular las ganancias del controlador $K$. Este esquema de control es implementado en el modelo de \textbf{Simulink} mostrado en la figura \ref{fig:esquema-controlador-retroalimentado}. 

\begin{figure}[htb]
\begin{center}
\centering
\includegraphics[width=.7\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/controlador_retroalimentado}
\caption{Esquema del controlador retroalimentado.}
\label{fig:esquema-controlador-retroalimentado}
\end{center}
\end{figure}

El esquema de control mostrado anteriormente es capaz de estabilizar el sistema pero no puede alcanzar un error de estado estable igual a $0$, por lo que se agrega un integrador y un vector de ganancias con el fin de producir un nuevo esquema como el mostrado en la sección \ref{sec:control-integral}. Este nuevo vector de ganancias es calculado por el script \ref{ap:ganancias-control-integral} y su modelo de Simulink es el que se muestra en la figura \ref{fig:esquema-controlador-integral}.

\begin{figure}[htb]
\begin{center}
\centering
\includegraphics[width=.8\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/controlador_integral}
\caption{Esquema del controlador integral.}
\label{fig:esquema-controlador-integral}
\end{center}
\end{figure}

\subsection{Observador}

Para realizar control en espacio de estados es necesario retroalimentar el estado completo del sistema. En el caso del RMH no se puede medir de manera directa todo los parámetros del vector de estados por lo que es necesario un observador de estados como es descrito en la sección \ref{sec:observador-estados}. 

Las ganancias del observador de estados $K_o$ son calculadas mediante el script \ref{ap:ganancias-control}. El modelo de \textbf{Simulink} correspondiente a este observador es mostrado en la figura \ref{fig:esquema-observador-estados}.

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=.85\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/observador_de_estados}
\caption{Esquema del observador de estados.}
\label{fig:esquema-observador-estados}
\end{center}
\end{figure}

\subsection{Discretización}

Debido a que los controladores suelen ser implementados en un sistema digital, es necesario contar con una versión discreta de los controladores presentados anteriormente.  

Como se indica en la sección \ref{sec:discretizacion-controladores}, para emular un sistema controlador-observador es necesario transformar los polos que definen la respuesta del sistema del dominio de Laplace al dominio de $Z$. Esto se realiza mediante la transformación de Tustin expresada en la ecuación \ref{eq:ecuacion-Tustin}.

Para el cálculo de las ganancias del controlador discreto, es necesario discretizar el sistema continuo y, con el nuevo conjunto de polos discretos, aplicar las técnicas de ubicación de polos descritas en la sección \ref{sec:discretizacion-controladores}. 

Los modelos continuos presentados anteriormente son discretizados y presentados en las figuras \ref{fig:esquema-controlador-discreto} y \ref{fig:esquema-observador-discreto}. Cabe resaltar que lo que era un integrador en el sistema continuo ahora es un acumulador en lugar de un retardo unitario ($Z^{-1}$).  

\begin{figure}[htb]
\begin{center}
\centering
\includegraphics[width=.85\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/controlador_discreto}
\caption{Esquema del controlador discreto.}
\label{fig:esquema-controlador-discreto}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\centering
\includegraphics[width=.85\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/observador_discreto}
\caption{Esquema del observador discreto.}
\label{fig:esquema-observador-discreto}
\end{center}
\end{figure}

\newpage

\subsection{Control calendarizado}

Con el fin de compensar los efectos de las no linealidades provocadas por la precesión del eje utilizamos el método de control calendarizado descrito en la sección \ref{sec:control-calendarizado}, en donde linealizamos en diferentes valores de $\Omega$ para obtener el conjunto de matrices de transición $A$, $B$, $C$ y el conjunto de ganancias $K$ y $K_o$ para el observador de estados. Estos cálculos son realizados por el script \ref{ap:generador-calendarizado} y el conjunto de matrices es interpolado durante la simulación del modelo de \textbf{Simulink} mostrado en las figuras \ref{fig:esquema-controlador-calendarizado} y \ref{fig:esquema-observador-calendarizado}. 

\begin{figure}[htb]
\begin{center}
\centering
\includegraphics[width=.9\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/controlador_caliderizado_discreto}
\caption{Esquema del controlador calendarizado.}
\label{fig:esquema-controlador-calendarizado}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\centering
\includegraphics[width=.85\textwidth]{images/Capitulo_3/Control_SIMULINK_MATLAB/observador_calendarizado}
\caption{Esquema del observador calendarizado.}
\label{fig:esquema-observador-calendarizado}
\end{center}
\end{figure}
