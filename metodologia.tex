\chapter{Marco Teórico}

Aunque algunas empresas han logrado fabricar e incluso comercializar rodamientos magnéticos, estos continúan bajo diversas investigaciones buscando mejorar los materiales y los componentes con los que se fabrican para mejorar su funcionamiento y optimizar el diseño. Sin embargo, la mayoría de las veces estos son diseñados por los desarrolladores para una aplicación o máquina en específico, por lo que no siguen una norma de diseño establecida.

Es por esto que, para el desarrollo de este proyecto, fue necesario aplicar una serie de procesos con base en las investigaciones y el desarrollo que han tendido tanto a nivel industrial como académico. Se realizaron consultas de diversos artículos y sitios web de fabricantes y desarrolladores que han logrado comercializar estos productos para la industria, y se efectuó una investigación documental sobre trabajos de varios grados e instituciones con el fin de marcar una referencia durante el desarrollo de este proyecto. Con base en la información adquirida, fueron considerados los siguientes procedimientos:

\begin{enumerate}
\item Definir a detalle el principio de funcionamiento de los diferentes tipos de rodamientos magnéticos realizando una investigación documental sobre los trabajos e investigaciones que se han hecho al respecto, y con esto establecer los requerimientos de diseño.
\item Recopilar información sobre los requerimientos de diseño de los electroimanes y la caracterización de algunos de los materiales ferromagnéticos comercializados.
\item Realizar una investigación de los tipos de sensores adecuados para las condiciones de operación requeridas. 
\item Realizar la división por áreas funcionales del proyecto basadas en diseños modulares; definir los diseños conceptuales de cada uno de ellos pensados para su análisis individual, considerando una posible fabricación futura y la integración de todos los módulos en una sola estructura.
\item Realizar los cálculos de la geometría y dimensiones del electroimán, los cuales sirven como parámetro en la delimitación del tamaño para el resto de los componentes y elementos.
\item Realizar el diseño a detalle de los módulos que componen los rodamientos magnéticos activos (radial y axial), el módulo de sensores y el módulo de compensación de cargas estáticas.
\item Diseñar la circuitería para la aplicación y control de corrientes en los electroimanes.
\end{enumerate}

Para poder realizar la etapa de diseño, es necesario realizar primeramente un análisis de los conceptos fundamentales y principios básicos en cuanto a la teoría propia del proyecto y los procedimientos a emplear. Dicho estudio se llevará a cabo a lo largo del desarrollo de este capítulo.

\newpage

\section{Conceptos fundamentales}
\subsection{Origen del campo magnético}

Un campo magnético es producido a consecuencia de la existencia de cargas eléctricas en movimiento. Este campo magnético ejerce una fuerza sobre conductores con corriente y materiales magnetizados.

\begin{equation}
	 d \overrightarrow{H}=  \frac{Id \overrightarrow{l}\times\hat{r} }{4\pi r^{2}}
\end{equation}

La ley de Biot-Savart nos permite calcular la intensidad del campo magnético H generado por un segmento diferencial de la corriente eléctrica. Nótese que su magnitud decrece con respecto al cuadrado de la distancia.

El campo circula alrededor de un conductor simple en la dirección dada por la regla de la mano derecha:

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=6cm, height=4cm]{images/Capitulo_1/Campo_magnetico_en_un_conductor_sencillo}
	\caption{\textit{Campo magnético en un conductor sencillo.}}
\end{center}
\end{figure}
%\vspace*{3cm}

En el mismo año y de manera independiente, Ampère dedujo que las cargas en movimiento eran las causas del campo magnético. De acuerdo con la ley de Ampère, el campo magnético generado por un circuito eléctrico depende de la forma del circuito (trayectoria de conducción) y de la corriente. Asumiendo que cada circuito esta hecho de un número finito de elementos de corriente, cada uno contribuyendo al campo e integrando dichas contribuciones en un punto para determinar el campo, Ampère concluyó que: 

\begin{equation}
	 \oint {\overrightarrow{H} \cdot d \overrightarrow{l}} =  I_{enc}
\end{equation}

\subsection{Inducción magnética}
Cuando un campo magnético  H es generado por una corriente, de acuerdo a la ley de Ampère, la respuesta del medio es la inducción magnética B, también llamada densidad de flujo. Todos los medios responden con alguna inducción. En el vacío, la relación entre el campo magnetizante y la inducción es: \\ 	
\begin{equation}
	\overrightarrow{B} = \mu_0 \overrightarrow{H}
\end{equation}
						
Donde  $\mu_0$ es la permeabilidad magnética del vacío, una constante universal con valor $4\pi\times10^{-7}$.

\subsection{Flujo magnético}

Siempre que un campo magnético está presente, existirá un flujo magnético $ \phi$. Este flujo y su razón de cambio pueden ser medidos ya que genera una fuerza electromotriz (f.e.m.) en un circuito conductor a través del cual pasa este flujo. Pequeñas partículas como el hierro se alinean con la dirección del flujo. La cantidad de flujo producido depende de las propiedades del medio y varía de un medio a otro.

\begin{equation}
	\phi = \int_{s}^{} \overrightarrow{H} \cdot d \overrightarrow{s}
\end{equation}

El Weber es la unidad para medir la cantidad de flujo que, al ser reducido uniformemente a cero en un segundo, produce una f.e.m. de un Volt a través de una vuelta de conductor en la que atraviesa tal flujo.

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=6cm, height=4cm]{images/Capitulo_1/Flujo_magnetico}
	\caption{\textit{Flujo magnético.}}
\end{center}
\end{figure}

\section{Materiales magnéticos}
\subsection{Magnetización}

En muchos medios se tiene que $B$ es una función lineal de $H$; en particular, se puede decir que $B=\mu_0 H$. Si el valor de $B$ en el vacío es conocido, entonces H puede ser inmediatamente calculado.

Sin embargo, para otros medios (particularmente materiales ferromagnéticos), $B$ no es una función lineal de $H$ ni posee un mismo valor de $H$ para uno de $B$.

Ahora consideramos los efectos que un material tiene sobre la inducción magnética $B$ cuando un campo magnetizante pasa a través de él. Estos están representados por la magnetización, que puede ser incrementada en los materiales ferromagnéticos o reducida como es en el caso de los diamagnéticos. La permeabilidad relativa del material indica como varía el comportamiento de la inducción en el material con respecto a la inducción en el vacío.

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=6cm, height=4cm]{images/Capitulo_1/Dipolo_magnetico_de_un_atomo}
	\caption{\textit{Dipolo magnético de un átomo.}}
\end{center}
\end{figure}

Para el análisis de materiales magnéticos es necesario definir cantidades que representen la respuesta de estos materiales ante un campo magnético, dichas cantidades son el momento magnético y la magnetización. Una vez que se ha hecho, es posible considerar otra propiedad: la susceptibilidad (relacionada con la permeabilidad).

Se define a la magnetización $M$ como el momento magnético por unidad de volumen: 

\begin{equation}
	M = \frac{dm}{dV}
\end{equation}

A partir de la relación entre el momento magnético $m$ y el flujo se puede llegar a otra relación entre $M$ y $B$. Para una barra magnética con una densidad $\phi$ en el centro, una longitud de dipolo l y un área transversal A, se tiene un momento magnético de $m =\phi \mu_0$. Por tanto, la magnetización entonces está dada por $M = \frac{m}{Al}$. Entonces:

\begin{equation}
	M = \frac{\phi}{\mu_0A} = \frac{B}{\mu_0}
\end{equation}

En este caso ninguna corriente externa está presente para un campo magnetizante por $B = \mu_0 M$. Podemos ver que la magnetización $M$ y el campo magnetizante $H$ contribuyen a la densidad de flujo en maneras similares. Tanto la magnetización como el campo magnético están presentes por lo que sus contribuciones pueden ser sumadas.

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=10cm, height=4cm]{images/Capitulo_1/Dominios_magneticos_de_un_material}
	\caption{\textit{Dominios magnéticos para un material no magnetizado (izquierda) y uno magnetizado (derecha).}}
\end{center}
\end{figure}

\subsection{Permeabilidad y susceptibilidad magnética}

Los diferentes tipos de materiales magnéticos son clasificados de acuerdo a su susceptibilidad y permeabilidad. Luego entonces, se deben definir estas propiedades antes de describir las diferencias entre materiales ferromagnéticos, paramagnéticos y diamagnéticos. Para materiales isótropos y homogéneos la permeabilidad está definida como:

\begin{equation}
	\mu = \frac{B}{H}
\end{equation}

Y la susceptibilidad como:

\begin{equation}
	X=\frac{M}{H}
\end{equation}

Siendo que $B$ y $M$ pueden o no ser una función lineal de $H$, dependiendo del tipo de material o medio se debe recalcar que la permeabilidad y susceptibilidad podrían no ser constantes.

Es común usar el término permeabilidad relativa $\ mu_r$ definido como:

\begin{equation}
	\mu_r = \frac{\mu }{\mu_0}
\end{equation}

La permeabilidad relativa está siempre relacionada con la susceptibilidad tal que:

\begin{equation}
	\mu_r= X+1
\end{equation}

Y su relación con la inducción magnética está dada de la forma:

\begin{equation}
	B=\mu_0 (H + M)
\end{equation}

Los diferentes materiales magnéticos son clasificados de acuerdo a su susceptibilidad. El primer grupo son los materiales en los que $X$ es pequeña y negativa. Estos materiales son llamados diamagnéticos, donde su respuesta magnética se opone al campo magnético aplicado. Ejemplos de estos materiales son el cobre, la plata y el oro. Los superconductores forman parte también del grupo de materiales diamagnéticos, para los cuales $X=-1$.

El segundo grupo de materiales para los que $X$ es pequeña y positiva son los materiales paramagnéticos. La magnetización de los materiales paramagnéticos es débil y alineada con la dirección del campo magnetizante. Ejemplos de materiales paramagnéticos son el aluminio, platino y manganeso.

A temperatura constante y valores de campo $H$ relativamente bajos, la susceptibilidad de los materiales diamagnéticos y paramagnéticos es constante.

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=11cm, height=6cm]{images/Capitulo_1/Curva_de_magnetizacion}
	\caption{\textit{Curva de magnetización para materiales paramagnéticos y diamagnéticos con respecto al vacío.}}
\end{center}
\end{figure}

Los materiales magnéticos más prominentes son los ferromagnéticos al poseer una susceptibilidad positiva y mucho mayor a 1, cuyos valores típicos de $X$ varían entre las 50 hasta  las 10000. Ejemplos de estos materiales son el hierro, el cobalto, el níquel, los metales raros y sus aleaciones.

\newpage

\subsection{Saturación}

%Si un material tiene \textit{n} dipolos atómicos por unidad de volumen una vez que todos estos dipolos quedan alineados en paralelo, se alcanza la magnetización de saturación $M_0$. Se puede realizar una distinción entre la saturación técnica $M_s$  y la saturación completa $M_0$. 

Cuando se introduce un núcleo de material ferromagnético en una bobina y se le hace circular una corriente eléctrica, se genera un campo magnético en su interior de intensidad H, el cual orienta en cierto grado los dipolos de dicho núcleo ferromagnético. Esto refuerza el campo magnético con una inducción magnética B.\par 
Cuando se incrementa la intensidad de la corriente eléctrica, los dipolos se alinean más resultando en un aumento del campo magnético H. Esto se ve reflejado en un nuevo aumento de la inducción B.\par 
Si la corriente eléctrica continua en aumento, llegará el momento en que los dipolos se encontrarán alineados completamente, por lo que aunque la corriente sufra un mayor incremento, la intensidad de campo H ya no aumentará. Entonces, se dice que se ha alcanzado la saturación magnética.\par  
Por lo general, esta relación B-H no es constante, por lo que es de gran utilidad conocer la curva de magnetización, que representa el valor de la inducción en función de la intensidad de campo en cada material \cite{cite_s3_2017}.

% Electrónica general: equipos electrónicos de consumo, Pablo Alcalde San Miguel, Editorial Paraninfo, 2° Edicion. 

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=11cm, height=6cm]{images/Capitulo_1/Curva_de_magnetizacion_de_un_material_ferromagnetico}
	\caption{\textit{Curva de magnetización de un material ferromagnético.}}
\end{center}
\end{figure}

\newpage

\subsection{Histéresis}

%Los efectos de histéresis añaden más complicaciones debido a que la magnetización M del material depende no solo del campo magnético, sino también del historial de magnetización del material. Se han creado métodos para calcular los campos magnéticos en estos dispositivos, incluso en donde la histéresis se tiene en cuenta.

Después de haber sometido un material ferromagnético a la acción de un campo magnético por cierto tiempo, el material permanece con un cierto nivel de inducción magnética, que recibe el nombre de magnetismo remanente. A este fenómeno se le conoce como histéresis.\par
La histéresis es de gran importancia en el análisis de los materiales magnéticos, ya que produce pérdidas en los núcleos de los electroimanes cuando son sometidos a la acción de campos magnéticos alternos. Las pérdidas por histéresis son causadas por la pérdida de energía en forma de calor debido a la fricción que se produce cuando los dominios magnéticos se ven forzados a girar en diferentes sentidos al ser sometidos a la acción de un campo magnético alterno.\par
El área de la curva de histéresis corresponde a la pérdida de energía por unidad de volumen en un ciclo\cite{cite_s4_2017}. 
 
%Fundamentos de electromagnetismo para ingeniería. David K. Cheng. Editorial Pearson Educación.   

\begin{figure}[h!]
\begin{center}
\centering
	\includegraphics[width=11cm, height=7cm]{images/Capitulo_1/Curva_de_histeresis}
	\caption{\textit{Curva de histéresis.}}
\end{center}
\end{figure}

En el punto 0 el material no ha sido magnetizado nunca, por lo que la inducción magnética es nula.\par
En el segmento 0-a se va aumentando la intensidad del campo H, con lo que se consiguen valores crecientes de inducción hasta llegar a la saturación.\par 
En el segmento a-b se va reduciendo la intensidad de campo. La inducción también se reduce, pero no en la misma proporción que antes. En el punto b se ha anulado la intensidad de campo, sin embargo, el material manifiesta todavía un cierto magnetismo remanente.\par 
En el segmento b-c se invierte el sentido del campo magnético. En el punto c la inducción es cero, por lo que se ha conseguido eliminar por completo el magnetismo remanente.\par  
En el segmento c-d se sigue aplicando una intensidad de campo negativo, con lo que se consiguen niveles de inducción negativos hasta alcanzar la saturación.\par 
En los segmentos d-e, e-f y f-a se completa el ciclo de histéresis. La curva no pasa otra vez por el punto 0 debido a la histéresis. 

\subsection{Remanencia}

Una vez que el campo magnetizante es reducido a cero después de magnetizar un material ferromagnético, permanece una porción residual de magnetización y por consiguiente una inducción residual donde:

\begin{equation}
	B_R=\mu_0 M_R
\end{equation}

En una convención emergente se hace una distinción entre remanente y remanencia, donde la remanencia es usada para describir el valor residual de la magnetización después haber llevado el material a saturación, mientras que la magnetización remanente se refiere al valor residual después de magnetizar el material en un nivel arbitrario.

\subsection{Coercitividad}

La inducción magnética puede ser reducida a cero después de aplicar un campo magnetizante inverso de magnitud $H_c$. Esta intensidad de campo es conocida como coercitividad. Es fuertemente dependiente de la condición de la muestra, siendo afectada por factores como tratamientos térmicos y deformaciones.

La coercitividad intrínseca está definida como la intensidad de campo para la cual la magnetización es reducida a cero, en materiales ferromagnéticos suaves $H_c$ y $H_{ci}$ tiene un valor cercano, mientras que en materiales duros está clara una diferencia entre ellas con $H_{ci}$ siendo siempre mayor que $H_c$.

\subsection{Temperatura de Curie}

Cuando los materiales ferromagnéticos son calentados a temperaturas lo suficientemente altas se convierten en materiales paramagnéticos. A la temperatura de transición entre ferromagnetismo y paramagnetismo se le conoce como temperatura de Curie. Para esta temperatura, la permeabilidad de material baja súbitamente y ambas, coercitividad y remanencia, se vuelven cero.

\subsection{Materiales ferromagnéticos}

Podemos clasificar los materiales ferromagnéticos con base en su coercitividad. La coercitividad es un propiedad magnética dependiente de la estructura, esto significa que se puede alterar sometiendo al espécimen a diferentes tratamientos térmicos y mecánicos.

Fue descubierto que los materiales con base de hierro y alta dureza mecánica también presentaban una alta coercitividad, mientras que aquellos materiales más maleables tenían una coercitividad menor. Por lo tanto, los términos suaves y duros fueron usados para distinguir los materiales ferromagnéticos de acuerdo a esta propiedad. Los materiales duros poseen  una coercitividad sobre los $10K \frac{A}{M}$, mientras aquellos con una coercitividad menor a  $1k \frac{A}{m}$ son considerados como suaves.

La selección de un material ferromagnético será determinada por las características mostradas en sus lazos de histéresis. Materiales para transformadores necesitan una alta permeabilidad y baja histéresis debido a la necesidad de una alta eficiencia en la conversión de energía eléctrica. Los electroimanes requieren una baja coercitividad y remanencia para reducir fácilmente la magnetización a cero durante el apagado. Finalmente, los imanes permanentes requieren de una alta remanencia y coercitividad para retener la mayor magnetización posible.

\subsection{Aplicaciones de los materiales ferromagnéticos}

\subsubsection{Electroimanes}

Los materiales ferromagnéticos suaves son usados en electroimanes, motores, transformadores, y relés. Los materiales usados en el núcleo de los electroimanes deben de tener una alta permeabilidad, permitiendo alcanzar así una alta inducción magnética. Al mismo tiempo, debe poseer una baja coercitividad de manera que la inducción magnética pueda ser fácilmente revertida.

\subsubsection{Imanes permanentes}

Los imanes permanentes son una de las clases más importantes de materiales magnéticos, junto con los aceros eléctricos y los imanes de grabación. Los imanes permanentes tienen aplicaciones en motores eléctricos y generadores, parlantes, televisiones, galvanómetros y dispositivos de suspensión magnética.

El material se  determina a partir de su histéresis, la coercitividad y remanencia para estas aplicaciones. Es importante resaltar que estas propiedades magnéticas dependen fuertemente de los tratamientos a los que fue sometido el material. En años recientes se han descubierto algunos materiales para imanes permanentes basados en neodimio-hierro-boro, donde su coercitividad puede ser tan alta como $1.12x106 A/$, comparada con $0.72\times 106$ para el samario-cobalto.

Además de la coercitividad, otro parámetro de vital importancia es el producto energético $BH_{max}$. Este es obtenido mediante el producto máximo $BH$ en el segundo cuadrante  de la curva de histéresis y representa la energía magnética almacenada en el material y es usualmente especificado por los fabricantes de imanes permanentes.

\newpage

\section{Análisis de circuitos magnéticos}
%\label{sec:related:sec3}

Existen algunas situaciones en las que la trayectoria del flujo magnético se encuentra interrumpida por un espacio libre denominado entrehierro, el cuál es considerado de gran importancia para algunas aplicaciones ingenieriles con imanes permanentes, motores, generadores y otras máquinas eléctricas. \\
Sin embargo, el análisis en este tipo de circuitos magnéticos puede llegar a ser más complicados que calcular el flujo en un solo material, por lo que suelen usarse algunas simplificaciones de las ecuaciones de flujo magnético y campo magnetizante para realizar dicho análisis.\\ 
Realizando simplificaciones a partir de las ecuaciones de Maxwell, comenzando por la ley de Gauss, donde se establece la conservación del flujo magnético alrededor de un nodo.

\begin{equation}
	 \oint {\overrightarrow{B} \cdot d \overrightarrow{s}} = 0 \Rightarrow \phi_1 +\phi_2 ... + \phi_i = 0
\end{equation}

La fuerza magnetomotriz $\eta$ como la excitación magnética: 

\begin{equation}
	Ni = \oint {\overrightarrow{H} \cdot d \overrightarrow{l} = \eta}
\end{equation}

La reluctancia magnética $R$ dependiente de la geometría y material de la muestra:

\begin{equation}
	R = \frac{l}{\mu A}
\end{equation}

Y finalmente la relación entre estas, también conocida como ley de Hopkins:

\begin{equation}
	\phi = \frac{\eta}{R}
\end{equation}

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=11cm, height=7cm]{images/Capitulo_1/Elementos_de_un_circuito_magnetico}
	\caption{\textit{Elementos de un circuito magnético.}}
\end{center}
\end{figure}

\newpage

A partir de estas ecuaciones es posible el sencillo cálculo del flujo a través de elementos con diferentes longitudes medias, materiales y secciones transversales, mediante las técnicas de análisis de circuitos eléctricos y la relación entre los circuitos magnéticos y los circuitos eléctricos:

\begin{table}
\centering
\begin{tabular}{|c|c|c|c|}
\hline 
Circuitos magnéticos &  & Circuitos eléctricos &   \\ 
\hline
$\eta$ & Fuerza magnetomotriz & $\varepsilon$ & Fuerza electromotriz \\ 
\hline 
$\phi$ & Flujo magnético & $I$ & Corriente eléctrica \\ 
\hline 
 $R$ & Reluctancia & $r$& Resistencia eléctrica\\
\hline
\end{tabular} 
\end{table}
\newpage

\section{Electroimanes}


\subsection{Modelado}

Para diseñar un electroimán se requiere de un modelo que relacione la geometría del núcleo con la fuerza máxima que este puede ejercer. La fuerza esta determinada por:
\begin{equation}
	F =  \frac{(NI)^2}{2} \frac{d}{dy}(\mathcal{R}^{-1})
	\label{eq:electroiman:formula-general-fuerza}
\end{equation}
por lo que el problema de calcular la fuerza se reduce a calcular la reluctancia del circuito magnético que conforma el electroimán. 

%Procederemos a analizar los núcleos de geometría \ref{fig:geometria-radial} y \ref{fig:geometria-axial} correspondientes a los electroimanes radial y axial respectivamente.

\begin{figure}[htb]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/geometria_nucleo_radial}
        \caption{Geometría}
        \label{fig:geometria-radial}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/modelo_reluctancias_eir}
        \caption{Modelo de reluctancias}
        \label{fig:modelo-reluctancias-radial}
    \end{subfigure}
    \caption{Electroimán radial}
\end{figure}

El electroimán posee una geometría similar al de la figura \ref{fig:geometria-radial}, aplicando el análisis de circuitos magnéticos el sistema se puede modelar como el circuito de reluctancias de la figura \ref{fig:modelo-reluctancias-radial}. Entonces la reluctancia total puede escribirse como:

\begin{equation}
	\mathcal{R} = \mathcal{R}_e + \mathcal{R}_a + \mathcal{R}_g = (\frac{l_e}{\mu_{re}}+ \frac{l_a}{ \mu_{ra}}+ 2y)\frac{1}{\mu_0A} \label{eq:electroiman:reluctancia-total}
\end{equation}

En los materiales ferromagnéticos los valores de $\mu_r$ suelen ser grandes, por lo que es posible considerar los términos $\frac{l_e}{\mu_{re}}$ y $\frac{l_a}{ \mu_{ra}}$ como insignificantes. De esta forma, la reluctancia total puede expresarse como:

\begin{equation}
\mathcal{R} = \frac{2y}{\mu_0A}
\end{equation}

Aplicando la ecuación \ref{eq:electroiman:formula-general-fuerza}, la fuerza se determina con:

\begin{equation}
	F_m = - \frac{\mu_0 A N^2 I^2 }{ 4 y^2}
	\label{eq:electroiman:fuerza-ideal}
\end{equation}

La ecuación \ref{eq:electroiman:fuerza-ideal} puede encontrarse en la literatura \cite{cite_s4_2017},\cite{cite_s6_2017} y \cite{cite_s7_2017}. Esta ecuación se considera un caso ideal, ya que son despreciados los efectos del flujo de fuga, flujo marginal y la reluctancia del núcleo.

Si ponemos a prueba las ecuaciones bajo las condiciones de operación del rodamiento magnético (considerando un entrehierro pequeño), resulta en un error en la fuerza de n(insertar el valor de la simulación)\% comparado con la simulación de elemento finito. Esto es debido a que la reluctancia del entrehierro y la del núcleo se encuentran en el mismo orden de magnitud. 

%En cambio si realizamos simulacion en FEM, para el mismo sistema, la simulación arroja un valor de N.

Si reescribimos la ecuación \ref{eq:electroiman:fuerza-ideal} ahora sin ignorar los términos $\frac{l_e}{\mu_{re}}$ y $\frac{l_a}{ \mu_{ra}}$, se obtiene la ecuación:

\begin{equation}
	F_m = - \frac{\mu_0 A N^2 I^2}{(\frac{l_e}{\mu_{re}}+ \frac{l_a}{\mu_{ra}}+ 2y)^2}
	\label{eq:electroiman:fuerza-real}
\end{equation}

Rehaciendo los cálculos bajo las condiciones anteriores, se llega a una diferencia de tan solo n\% con respecto a la simulación de elemento finito. 

\begin{figure}[h]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/geometria_nucleo_axial}
        \caption{Geometría}
        \label{fig:geom-axial}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/modelo_reluctancias_eia}
        \caption{Modelo de reluctancias}
        \label{fig:modelo-axial}
    \end{subfigure}
    \caption{Electroimán axial}
\end{figure}

Repitiendo el análisis para el electroimán axial con geometría \ref{fig:geom-axial},  obtenemos el modelo de reluctancias de la figura \ref{fig:modelo-axial} al igual que en el electroimán radial la fuerza y la reluctancia quedan determinadas por las ecuaciones \ref{eq:electroiman:reluctancia-total}, con la diferencia de que el área corresponde a una sección transversal circular. 

Si comparamos los resultados de estas ecuaciones con la simulación de elemento finito podemos observar un error de n\% en la fuerza ejercida. Esta es una gran desviación comparada con los resultados del electroimán radial.

%Para un electroimán axisimétrico donde la geometría cumple condiciones de xx, xx. calculamos una fuerza xx N, sin embargo la simulación FEM nos arroja un valor de xx.

Si analizamos los resultados de la simulación podemos observar que las líneas del flujo magnético se curvan de manera significativa en los extremos del imán. A esta distorsión en el campo magnético debido a las discontinuidades del medio se le conoce como flujo marginal.

Entonces para el correcto modelado del electroimán necesitamos incluir los efectos del flujo marginal. En \cite{cite_s8_2017_paper} se presenta un nuevo método para modelar la reluctancia de un entrehierro. Usando este nuevo modelo los resultados de la simulación se acercan en un n\%.   

\subsection{Proceso de diseño} \label{sec:diseno-elec}

Ahora que tenemos un modelo adecuado para la fuerza de los electroimanes, es necesario un procedimiento para diseñarlos. Desafortunadamente en la literatura no existe un método formal para el diseño de electroimanes.  A continuación presentaremos cómo los diferentes parámetros afectan el desempeño y características del electroimán, para después concluir con un procedimiento para su diseño. 

Idealmente queremos diseñar un electroimán pequeño, de bajo consumo y que pueda ejercer la fuerza $F_{min}$ que necesitamos a una distancia $d$.

Empezando por los requerimientos de fuerza y tamaño, en la ecuación \ref{eq:electroiman:fuerza-real} se puede apreciar que la fuerza depende de la sección transversal del núcleo y los amperes/vuelta del devanado ($NI$), por lo que para minimizar el tamaño del electroimán necesitamos incrementar el valor de $NI$. Como se puede apreciar en la siguiente ecuación, la densidad de flujo solo depende de los amperes/vuelta y de la distancia de operación del electroimán: 

\begin{equation}
	B = \frac{\phi}{A} = \frac{\mu_0 NI}{2y}
\end{equation} 

Esto significa que el punto de saturación del material impone un límite en el valor máximo aplicable de $NI$, si es que queremos mantenernos en el régimen lineal del material. Esto para minimizar las pérdidas por histéresis y facilitar el modelado.Esto implica que materiales con un punto de saturación más alto son mejores para aplicaciones con electroimanes. Entonces el número máximo de amperes/vuelta quedará determinado por:

\begin{equation}
NI_{max}= \frac{2yB_{sat}}{\mu_0}
\end{equation}

Conociendo ahora la $F_{MM}$ máxima que podemos aplicar al núcleo, solo nos queda variar la sección transversal del entrehierro para generar la fuerza requerida $F_min$ mediante la fórmula:

\begin{equation}
NI = \sqrt[2]{\frac{4 F_m y^2}{\mu_0 A}}
\end{equation}

Falta ahora determinar los valores de $N$ e $I$, la relación de estos dos términos es de suma importancia ya que ambos determinan las características eléctricas del electroimán definidas por los términos de inductancia $L$ y resistencia $R$. La inductancia, como se verá más adelante, limitará la respuesta en frecuencia de los electroimanes mientras que la resistencia determinará la eficiencia.

La inductancia está determinada por:

\begin{equation}
L = \frac{ \lambda }{I} = \frac{N \Phi}{I} = \frac{N^2}{\mathcal{R}}
\end{equation}

mientras que la resistencia de la bobina del electroimán esta dada por: 

\begin{equation}
R = \frac{N l \sigma}{A}  
\end{equation}

Donde $l$ es la longitud promedio de una espira, $A$ es la sección transversal del conductor, $\sigma$ la resistividad del conductor y N es el número de vueltas. Las pérdidas por efecto joule provocadas por esta resistencia están dadas por:

\begin{equation}
W = I^2R 
\end{equation}

Las pérdidas no dependen del balance entre N e I ya que se compensan entre sí, usar un número reducido de vueltas requiere emplear una gran corriente y por lo tanto un conductor más grueso. En contraste, utilizar un calibre menor limita la corriente máxima de la bobina, lo cual requiere un mayor número de vueltas. En este caso es recomendable atenerse a las tablas de conductores AWG.   

Entonces la relación N e I deberá ser guiada por el valor deseado de inductancia que se adecua a la respuesta en frecuencia de los electroimanes y el voltaje de operación de la electrónica de accionamiento. 

Teniendo en consideración todo lo anterior podemos resumir el proceso de diseño de un electroimán en los siguientes pasos:

\begin{enumerate}
\item Determinar condiciones de operación y, v, $f_{max}$, $F_{max}$, $W_{loss_max}$. 
\item Seleccionar un material con un $B_{sat}$ y $\mu_r$ elevados. 
\item Calcular $NI_max$.
\item Calcular A.
\item Determinar $L_max$.
\item Calcular N e I.
\item Realizar una simulación FEM para validar. 
\end{enumerate}

\newpage
\subsection{Efecto marginal (Fringing)} \label{sec:flujo-marginal}

Calcular la reluctancia de un componente inductivo permite determinar de manera rápida y directa la inductancia y flujo magnético, haciendo posible evitar la saturaci\'on del núcleo al dise\~nar un sistema de electroimanes.
Existen diferentes métodos para calcular la reluctancia del entrehierro. En un modelo ideal con una distribución de densidad de flujo homogénea y sin flujo marginal, la reluctancia del entrehierro se puede calcular como:  

\begin{equation}
	\mathcal{R}_g = \frac{l_g}{\mu_0A_g}
	\label{eq:marginal:reluctancia-ideal}  
\end{equation} 

Donde $l_g$ y $A_g$ son la longitud y sección transversal del entrehierro respectivamente, y $\mu_0$ es la permeabilidad del espacio libre. La ecuación \ref{eq:marginal:reluctancia-ideal} s\'olo aplica cuando el flujo marginal es pequeño comparado con el flujo total, como cuando la longitud del entrehierro es muy pequeña comparada con su sección transversal. 

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.625\textwidth]{images/Capitulo_3/diagrama_flujo_maginal}
    \caption{Diagrama de flujo marginal.}
\end{figure}

Se conocen dos enfoques para la consideración en el flujo marginal para calcular la reluctancia del entrehierro: \\

\begin{enumerate}
\item El enfoque del Método de la Transformación Conformal Schwarz-Christoffel:	se basa en la analogía capacitancia-reluctancia para calcular la reluctancia del entehierro. Sin embargo, este enfoque nos conduce a una solución relativamente compleja y difícil de manejar. 
\item Aumento del área transversal del entre hierro: el flujo marginal puede ser tomado en consideración aumentando la sección transversal del entrehierro, y con esto reduciendo la reluctancia a su valor real. Este incremento de la sección transversal debe estar en función de la longitud del entrehierro $l_g$. La aproximación más común presentada en [...] consiste en extender la sección transversal en una magnitud de $l_g$ como se muestra en la ecuación:

\begin{equation}
	\mathcal{R}_g = \frac{l_g}{\mu_0(a+l_g)(d+l_g)}
	\label{eq:marginal:reluctancia-aproximacion}  
\end{equation}  
 
Esta aproximación carece de una derivación y explicación formal y sus resultados difieren de la simulación FEM. 
\end{enumerate}

En [...] se presenta un método para modelar la reluctancia tomando en cuenta el flujo marginal, el cual considera el flujo en tres dimensiones, es fácil de manejar y cuenta con un alto grado de exactitud. 
Este método surge a partir de aplicar la transformación Schwarz-Christoffel al sistema de la figura [1...] con el fin de calcular su reluctancia por unidad de longitud (reluctancia planar). Esta reluctancia queda determinada por: 

\begin{equation}
	R^\prime_{basic} = \frac{1}{\mu_0[\frac{\omega}{2l} + \frac{2}{\pi}(1 +ln\frac{\pi h}{4l})]} 
\end{equation}

%Inserte imagen (figura 3 del paper)

La figura [1...] se toma como base para calcular estructuras de entrehierro más complejas. La figura [4 paper] muestra cómo se pueden alcanzar diferentes geometrías a partir del modelo básico, además de establecer los valores de $\omega$ y $l$. El valor $h$ representa la distancia desde el borde del entrehierro a la siguiente esquina del n\'ucleo.

%Inserte imagen (figura 4 del paper)

Con el fin de considerar la tridimensionalidad del entrehierro, se introduce un factor de corrección que describe en qué medida disminuye la reluctancia del entrehierro debido al flujo marginal comparado con la reluctancia ideal. 
El factor de corrección que considera los efectos en la dirección $x$ se obtiene calculando la reluctancia planar $R^\prime_{basic}$ y dividiéndola entre la reluctancia planar ideal (visto desde el plano $xz$):

\begin{equation}
	\sigma_x = \frac{R^\prime}{\frac{a}{\mu_0t}}
\end{equation}

De manera similar, también se puede deducir el factor de corrección en la dirección $y$:

 \begin{equation}
	\sigma_y = \frac{R^\prime}{\frac{a}{\mu_0b}}
\end{equation}

Inserte imagen (figura 5 del paper)

El factor de corrección 3D se obtiene multiplicando los dos factores de franja $\sigma_x$  y $\sigma_y$:

\begin{equation}
	\sigma = \sigma_x	\sigma_y
\end{equation}

La reluctancia del entrehierro se puede entonces calcular fácilmente como:

\begin{equation}
	R_{m,airgap} = \sigma \frac{a}{\mu_0 t b}
\end{equation}

Así mismo, el factor de corrección que considera los efectos marginales en un sistema axisimétrico es: 

\begin{equation}
	\sigma_r = \frac{R^\prime}{\frac{l_g}{\mu_0 r}}
\end{equation}

Donde $l_g$ es la longitud del entrehierro, $r$ el radio del entrehierro, y $R^\prime$ representa la reluctancia planar (incluyendo los efectos marginales). Como consecuencia, la reluctancia real se puede calcular como:

\begin{equation}
	R_g = \sigma_r \frac{l_g}{\mu_0 r^2 \pi}
\end{equation}

\subsection{Calculo de conductores} \label{sec:calc-conductores}

El calibre de los conductores depende únicamente de la intensidad de corriente eléctrica que circula a través de ellos. La selección del calibre se hace a través de las tablas de conductores AWG\cite{cite_c1_2017}. El AWG (American Wire Gauge) es una sistema estandarizado usado predominantemente en Norteamérica para la clasificación de los diámetros de conductores eléctricos. 

Existen tablas que relacionan un calibre AWG con la corriente máxima que soporta el elemento conductor dependiendo del material del que esté hecho. Los materiales más usados son el aluminio y el cobre recocido, pero debido a que posee una mejor conductividad eléctrica se selecciona el cobre. A continuación se muestra la tabla AWG para cobre esmaltado: 

\begin{table}
\centering
\begin{tabular}{|c|l|c|c|c|c|}
\hline 
AWG & Di\'ametro & Area\;($mm^2$) & Resistencia (ohms/km) & Corriente Máxima & Frecuencia Máxima\\ 
\hline 
17 & 1.15062 & 1.04 & 16.60992 & 2.9 & 13 $kHz$ \\ 
\hline 
18 & 1.023 & 0.823 & 20.94 & 2.3 & 17 $kHz$ \\
\hline 
19 & 0.91186 & 0.653 & 26.40728 & 1.8 & 21 $kHz$ \\
\hline 
\end{tabular} 
\caption{Especificaciones técnicas para el alambre de cobre esmaltado.}
\label{tabla:AWG-COBRE}
\end{table}

El área del embobinado del electroimán depende directamente del número de vueltas requeridas y del calibre del conductor magnético. También se debe considerar el factor de empaquetamiento de la bobina, el cuál toma en cuenta la forma en que se distribuye el alambre en el embobinado.

Existen dos configuraciones para el embobinado: la lineal y la hexagonal, cada una con su propio factor de empaquetamiento. Como se observa en la figura \ref{fig:paq-bobina}, la configuración hexagonal aprovecha al máximo el área del embobinado al  dejar menos cavidades entre los conductores. Además, la construcción en esta configuración es más sencilla de realizar.   

\begin{figure}[h!]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/empaquetamiento_cobre_1}
        \caption{Configuraci\'on Lineal}
        \label{fig:empaq-lineal}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.4\textwidth}
        \includegraphics[width=\textwidth]{images/Capitulo_2/empaquetamiento_cobre_2}
        \caption{Configuraci\'on Hexagonal}
        \label{fig:empaq-hex}
    \end{subfigure}
    \caption{Configuraciones de empaquetamiento\cite{cite_c2_2017}}\label{fig:paq-bobina}
\end{figure}

Para calcular el área de la sección transversal de la bobina se utiliza la siguiente ecuación:

\begin{equation}
	Ab = \frac{Ac \; \cdot \; V}{K} 
	\label{eq:area-bobina}
\end{equation}
\begin{itemize}
	\item $Ab$ = \'Area m\'inima de la bobina
	\item $Ac$ = \'Area de secci\'on transversal del conductor
	\item $V$ = Vueltas m\'inimas  requeridas de la bobina
	\item $K$ = Factor de empaquetamiento  de la bobina  dada por 0.90\cite{cite_c2_2017} 
\end{itemize}

\section{Imanes permanentes}
\subsection{Análisis del imán permanente}

Proponiendo un imán permanente y guía de flujo magnético con la siguiente geometría:

\begin{figure}[htb]
\begin{center}
\centering	
	\includegraphics[width=5cm, height=5cm]{images/Capitulo_1/Circuito_magnetico_de_iman_permanente}
	\caption{\textit{Circuito Magnético de imán permanente.}}
\end{center}
\end{figure}

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=5cm, height=5cm]{images/Capitulo_1/Geometria_de_iman_y_ferrita_guia}
	\caption{\textit{Geometría de imán y ferrita guía.}}
\end{center}
\end{figure}

Asumiendo que el plato tiene una permeabilidad relativa infinita y que el imán posee una curva de desmagnetización lineal de la forma:

\begin{equation}
	B_m = B_r + \mu_rH_m
\end{equation}

Teniendo en cuenta la falta de fuerza magnetomotriz:

\begin{equation}
	H_m l_m +2Hg = 0 
\end{equation}

Y finalmente la conservación de flujo magnético:

\begin{equation}
	B_m A_m = 2B_g A_g
\end{equation}

Podemos calcular la inducción magnética en el entrehierro:

\begin{equation}
	  B_g(g) = (\frac{A_m}{A_g}) \frac{B_r}{2(1+(\frac{\mu_m}{\mu_0})(\frac{A_m}{A_g})(\frac{g}{l_m}))} 
\end{equation}

Y por consiguiente, la fuerza aplicada por el imán permanente debido a una variación en la energía aplicada en el entrehierro:

\begin{equation}
	F_g(g)= \frac{1}{2} \mu_0  \oint \oint B_g^2 ds \hat{n}
\end{equation}

\begin{equation}
	F_g(g)= \frac{1}{2 \mu_0} (2B-^2(g)A_g +B_m^2A_m)  \hat(n)
\end{equation}

\begin{equation}
	F_g(g) = \frac{B_r^2}{2 \mu_0 (1 + (\frac{\mu_m}{\mu_0})(\frac{A_m}{A_g})(\frac{g}{l_m}))^2}[\frac{A_m + 2A_g}{2Ag}] \hat{n}
\end{equation}

Donde son:\\
	$A_m$: La sección transversal del imán permanente\\
	$A_g$: La sección transversal del entrehierro\\
	$l_m$: La longitud media del imán permanente\\
	$B_r$: La inducción remanente\\
	$H_c$: La coercitividad\\
	$\mu_m$: La permeabilidad magnética del imán permanente definida como  $\frac{B_r}{H_c}$\\
	$g$: La distancia de entrehierro\\


\section{Sensores de desplazamiento}

\subsection{Tipos de sensores}

La mayoría de los sensores de desplazamiento de alta precisión requieren de contacto directo como los encoders de cuadratura, potenciómetros y sensores LVDT (Linear Variable Differential Transformer).
Los sensores que no requieren de contacto directo con el objeto se basan en la transformación de energía (transductores) o en la medición de alguna propiedad fundamental (resistencia, capacitancia, inductancia) para la detección de esa distancia. Entre los sensores de tipo transductor encontramos los sensores ultrasónicos que:

\begin{enumerate}
	\item Emiten ondas sónicas de alta frecuencia.
	\item Las ondas viajan hasta el objeto a detectar y son reflejadas sobre su superficie (siempre y cuando las características del material lo permitan en mayor o menor medida).
	\item Las ondas reflejadas son detectadas y tiempo entre la transmisión de onda y la recepción es medido. Este tiempo es función directa de la distancia del objeto y la velocidad de propagación en el medio por que la distancia es calculada.
\end{enumerate}

Estos sensores tienen la desventaja de poseer un rango mínimo de 10-20$cm$ y un rango máximo determinado por la potencia de la señal transmitida. Estas características, además del tamaño del transductor, no parecen ser una solución al problema de medición.

Otros sensores de operación similar son los sensores de tipo "time of fligth" (tiempo de vuelo). Estos operan emitiendo un haz de luz no visible en lugar de ondas ultrasónica, poseen un rango reducido, su resolución es baja y su tiempo de respuesta es lento.

Los inductivos son especialmente útiles para la detección de materiales metálicos y ferromagnéticos pero debido a la presencia de un campo variable generado por los electroimanes adyacentes, sus mediciones podrían presentar errores debido a la interferencia.

Por otro lado los sensores capacitivos presentan una alta resolución, rango reducido y una detección de objetos no aterrizados y sin contacto (siempre y cuando el objeto posea una permitividad mayor a la del vacío), además de poseer una respuesta ultrarrápida.

\subsection{Sensores de desplazamiento capacitivo}

Los capacitores son dispositivos que consisten en dos electrodos separados por un aislante, los capacitores generalmente se componen de dos placas conductivas separadas por un material no conductivo llamado dieléctrico. La energía eléctrica o carga es almacenada en estas placas.

Una vez que un voltaje es aplicado a través de las terminales del capacitor, los platos conductivos comenzarán a almacenar energía eléctrica hasta que la diferencia de potencial entre estas sea igual al voltaje aplicado por la fuente de voltaje. La carga eléctrica permanece en las placas incluso después de desconectar la fuente de voltaje a menos que otro componente consuma esta carga o el capacitor se descargue a cusa de las fugas de corriente debido la imperfecciones del aislante dieléctrico.

Un sensor capacitivo convierte el cambio eléctrico entre dos conductores a una señal eléctrica. Los sensores se construyen variando algunos de los parámetros que influyen en la capacitancia, que de acuerdo a la ecuación  de capacitancia entre placas paralelas; serían el área, la distancia entre placas o la permitividad del dieléctrico.

\begin{equation}
C=F(d,A,\varepsilon_r)
\end{equation}

Un sensor de proximidad es un transductor que es capaz de detectar la presencia de un objeto sin contacto físico. Normalmente un sensor de proximidad emite algún campo electromagnético o electrostático, o un haz de radiación electromagnética (radiación infrarroja) y detecta cualquier cambio en el campo o señal de retorno.\\ 
Los sensores de proximidad capacitivos consisten en un oscilador cuya frecuencia está determinada por la capacitancia del circuito al cual los electrodos están conectados. Cuando un conductor aterrizado o un material con una alta permeabilidad eléctrica se acercan al electrodo, la capacitancia cambia la frecuencia del oscilador. Este cambio es detectado y enviado a la unidad de control. El objeto detectado se le refiere comúnmente como objetivo. El campo eléctrico distribuido alrededor del capacitor experimenta un cambio que es detectado por la unidad de control.

\begin{figure}[htb]
\begin{center}
\centering	
	\includegraphics[width=5cm, height=5cm]{images/Capitulo_1/Interaccion_del_campo_electrico_en_un_capacitor_aire}
	\caption{\textit{Interacción del campo eléctrico en un capacitor de placas coplanarias con espacio frontal relleno de aire.}}
\end{center}
\end{figure}

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=5cm, height=5cm]{images/Capitulo_1/Interaccion_del_campo_electrico_en_un_capacitor_aire_dielectrico}
	\caption{\textit{Interacción del campo eléctrico en un capacitor de placas coplanarias con espacio frontal relleno de dieléctrico.}}
\end{center}
\end{figure}

La distancia máxima que el sensor de proximidad es capaz de detectar es conocido como rango nominal. Algunos sensores tienen ajustes del rango nominal o maneras de reportar una detección graduada de la distancia, un sensor de proximidad ajustado a un rango muy limitado es comúnmente referido como un sensor táctil. Los sensores capacitivos usualmente tienen el doble de rango los sensores inductivos.

\subsubsection{Suceptibilidad a capacitancias parásitas}
Los electrodos del sensor poseen capacitancias en el rango de fracción de picofaradios y conectar esas señales a un cable coaxial de 60pF por metro podría obscurecer totalmente la señal. Sin embargo, con el blindaje correcto al igual que cualquier otra capacitancia parásita, es posible eliminar en mayor medida los efectos  del ruido.

\subsubsection{Susceptibilidad al ruido}
Un peligro para los circuitos osciladores es que la frecuencia variaría de manera intermitente en el caso de existiría interferencia cruzada causada por circuitos adyacentes. Estos problemas pueden ser resueltos mediante un blindaje, una correcta disposición de pistas e integrados en el circuito y el uso de capacitores de "bypass" en las fuentes de alimentación.

\subsubsection{Distancia entre los electrodos}
La capacitancia depende del entrehierro o distancia entre los electrodos conductivos. Esta distancia puede incrementar o decrementar dependiendo de las condiciones ambientales, y del material que podrían generar mediciones poco exactas, por ejemplo suciedad en la superficie del sensor.

\newpage


\section{Sistemas dinámicos}
\subsection{Sistemas}

Un sistema es un conjunto de partes o elementos organizados y relacionados que interactúan entre sí para lograr un objetivo. Los sistemas reciben datos, energía o materia del ambiente \textbf{(entrada)}, y proveen información, energía o materia \textbf{(salida)}. Los sistemas pueden ser de tipo \textbf{físicos} (compuestos por equipos, maquinaria, objetos y cosas reales), o \textbf{abstractos} (compuestos por conceptos, planes, hipótesis e ideas). Su clasificación puede estar dada por su interacción con el ambiente:

\begin{itemize}
\item\textbf{Cerrados}: No presentan intercambio con el medio ambiente que los rodea, son herméticos a cualquier influencia ambiental. No reciben ningún recurso externo y producen nada que sea enviado hacia afuera. Siendo en rigor que no existen sistemas cerrados, el comportamiento de estos es determinista y programado, y operan con un muy pequeño intercambio de energía y materia con el ambiente. Por ello, usualmente se aplica el término a los sistemas completamente estructurados, donde los elementos y relaciones se combinan de una manera peculiar y rígida produciendo una salida invariable, como las máquinas.

\item\textbf{Abiertos}: Presentan intercambios con el ambiente en forma de energía y materia, a través de entradas y salidas. Su estructura es óptima cuando el conjunto de elementos del sistema se organiza, aproximándose a una operación adaptativa.
\end{itemize}

Los sistemas \textbf{dinámicos} son aquellos cuyos parámetros internos (variables de estado) siguen una serie de reglas temporales. Se llaman sistemas porque están descritos por un conjunto de ecuaciones \textbf{(sistemas)} y dinámicos porque sus parámetros varían con respecto a alguna variable que generalmente es el tiempo. 
Los sistemas dinámicos pueden dividirse en dos grandes clases: aquellos en los que el tiempo varía \textbf{continuamente} y en los que el tiempo varía \textbf{discretamente}. Los sistemas dinámicos de tiempo continuo se expresan en ecuaciones diferenciales ordinarias. Por otro lado, si el tiempo es discreto, los sistemas se describen por medio de ecuaciones de diferencias también conocidos como mapas iterados.\\

Un sistema que responde a una entrada con una salida, únicamente después de que esta fue aplicada es conocido como causal. Lo que se busca en el modelado es que, a partir de un conjunto de leyes físicas, se llegue a un sistema de ecuaciones diferenciales que después serán de ayuda para diseñar un control adecuado. Debido a la naturaleza mixta del sistema, las ecuaciones resultantes incluirán términos tanto del dominio mecánico como del dominio electromagnético. Posteriormente este conjunto de ecuaciones no lineales serán linearizadas con el fin de aprovechar las técnicas de control moderno.

En parte se pueden clasificar como:
\begin{itemize}
\item Lineales o no lineales
\item Determinísticos o estocásticos
\item Variantes o invariantes en el tiempo
\end{itemize}

\subsection{Sistema LTI}

Los sistemas lineales e invariantes en el tiempo (sistemas \textbf{LTI}, por sus siglas en inglés \textbf{\textit{Linear and Time Invariant}}) corresponden a una importante clase de sistemas en el análisis de fenómenos reales, al permitir modelar comportamientos complejos con herramientas matemáticas tan poderosas como las transformadas de Fourier y Laplace.

Los sistemas LTI son sistemas que tienen una ecuación diferencial de la forma:

\begin{equation} \label{eq:def_lti}
a_n\frac{d^ny(t)}{dt^n} + a_{n-1}\frac{d^{n-1}y(t)}{dt^{n-1}} + ... + a_1\frac{dy(t)}{dt} +a_0y(t) = b_0F(t) + b_1\frac{dF(t)}{dt} +...+ b_{m-1}\frac{d^{m-1}F(t)}{dt^{m-1}} + b_m\frac{d^mF(t)}{dt^m}
\end{equation}

Donde $y$ es la salida del sistema y $F$ es la entrada. 
La relación de entrada-salida para los sistemas LTI se describe en términos de una operación de convolución. La importancia de la operación de convolución en sistemas LTI proviene del hecho de que el conocimiento de la respuesta de un sistema LTI a la entrada de impulsos unitarios nos permite encontrar su salida a cualquier señal de entrada. La linealidad y la invarianza en el tiempo juegan un papel fundamental por varias razones:

\begin{itemize}
\item Muchos procesos físicos son LTI $\Rightarrow$ si pueden modelarse como sistemas LTI.
\item Poseen la propiedad de superposición (linealidad) $\Rightarrow$ si la entrada a un sistema LTI se puede representar como combinación lineal de un conjunto de señales
básicas (concepto de base de señales),así la salida será la misma combinación lineal
de las respuestas del sistema a esas señales básicas.
\item Cualquier señal se puede representar como combinación lineal de impulsos unitarios retardados. Esto nos permitirá caracterizar cualquier sistema LTI mediante su respuesta al impulso unitario. Esta representación se conoce como suma de convolución (sistemas LTI discretos) o integral de convolución (sistemas continuos) y proporciona una gran comodidad al tratar los sistemas LTI.
\end{itemize}

\subsubsection{Diferentes representanciones}

Las representaciones de un sistema LTI son las siguientes: 
\begin{itemize}
  \item Sistemas de ecuaciones diferenciales (anteriormente mencionado en la ecuación \ref{eq:def_lti})
\item Función de tranferencia: La función de transferencia de un sistema descrito mediante una ecuación diferencial lineal e invariante en el tiempo se define como el cociente entre la transformada de Laplace de la salida (función de respuesta) y la transformada de Laplace de la entrada (función de excitación) bajo la suposición de que todas las condiciones iniciales son cero.
\begin{equation}
	G_{(s)} = \frac{\mathcal{L}[entrada]}{\mathcal{L}[salida]}
\end{equation}
A partir del concepto de función de transferencia, es posible representar la dinámica de un sistema mediante ecuaciones algebraicas en s.
\item Variables de estado: Las variables de un sistema dinámico son las variables que constituyen el menor conjunto de variables que determinan el estado del sistema dinámico. Si al menos se necesitan $n$ variables $X_1, X_2,...,X_n$ para describir completamente el comportamiento de un sistema dinámico (de forma que una vez que la entrada para $ t\geq t_0 $ está dada y el estado inicial  en $t = t_0$ esta especificado, el estado futuro del sistema está determinado  completamente), entonces tales $n$ variables son un cojunto de variables de estado.
\end{itemize}

El estado de un sistema dinámico es el conjunto de variables más pequeño (llamadas
variables de estado), de forma que el conocimiento de estas variables en $t = t_0$, junto con el conocimiento de la entrada para $ t\geq t_0 $, determinan completamente el comportamiento del sistema en cualquier $ t\geq t_0 $.

\subsubsection{Respuestas de los sistemas LTI de segundo orden}

Las ecuaciones diferenciales lineales de coeficientes constantes de segundo orden, describen las dinámicas de sistemas y es importante para el diseño de controladores ya que habitualmente la mayor parte de los sistemas pueden ser aproximados a un sistema de segundo orden:
\begin{equation}
	a_{2}\frac{d^{2}y(t)}{dt^{2}} + a_1\frac{dy(t)}{dt} 		+a_0y(t) = b_0x(t) + b_1\frac{dx(t)}{dt} +b_{2}\frac{d^{2}x(t)}{dt^{2}}
\end{equation}

Y su forma est\'andar de la funci\'on de tranferencia es la siguiente:
\begin{equation}
	G_{(s)} =  \frac{\omega^2_n}{s^2 + 2\varsigma \omega_ns + \omega^2_n}
\end{equation}

En la que el polinomio del denominador se denomina polinomio característico, cuyas raíces (solución de la ecuación característica) son los polos de la función de transferencia; donde $ \omega_n$ es la frecuencia natural no amortiguada y $\varsigma$ es el factor de amortiguamiento de la se\~nal. El comportamiento d\'inamico del sistema de segundo orden se describe en términos de los parámetros $\omega$ y $\varsigma$. En el comportamiento subamortiguado, donde $0 < \varsigma < 1$, se aproxima a cero más rápidamente que en el comportamiento críticamente  amortiguado pero termina oscilando alrededor de cero. Para el comportamiento críticamente  amortiguado, donde $\varsigma = 1$, se proporciona la forma más rápida de aproximarse a cero y para el comportamiento sobreamortiguado, donde $\varsigma > 1$, se aproxima a cero pero más lento que en el caso críticamente amortiguado.

\subsubsection{Estabilidad}

La estabilidad de un sistema puede pensarse como una continuidad en su comportamiento dinámico. Si se presenta un cambio pequeño en las entradas o condiciones iniciales, un sistema estable presentará modificaciones pequeñas en su respuesta perturbada. Por otro lado, en un sistema inestable cualquier perturbación, por pequeña que sea, llevará a los estados y/o a las salidas a crecer sin límite o hasta que el sistema se salga del rango dinámico o se descontrole y en el diseño de un sistema de control este tipo de eventos no deben presentarse. 

La respuesta de los sistemas dinámicos lineales se descompone en la respuesta a estado cero y respuesta a entrada cero. Así mismo, se habla de dos tipos de estabilidad: la estabilidad interna, que se refiere a la estabilidad del sistema autónomo (sin entradas) y describe el efecto de perturbaciones en las condiciones iniciales sobre comportamiento dinámico de los estados del sistema, y la estabilidad externa (de Entrada $-$ Salida), que se refiere a la estabilidad del sistema con condiciones iniciales nulas y describe el efecto de perturbaciones en las entradas sobre el comportamiento dinámico de la salida.

La estabilidad interna recibe el nombre del científico ruso Alexander Mikhailovich Lyapunov, quien realizó estudios en el tema a fines del siglo XIX. Lyapunov introdujo por primera vez métodos que permiten determinar la estabilidad de sistemas de ecuaciones diferenciales sin necesidad de calcular explícitamente las soluciones. La estabilidad, en el sentido de Lyapunov, hace hincapié en las propiedades de los puntos de equilibrio, y se basa en una generalización matemática del concepto de energía de sistemas mecánicos. Los métodos de Lyapunov pueden aplicarse a sistemas no lineales y no estacionarios.

\subsection{LTI discretos}

Un sistema discreto se caracteriza por que su variable independiente sólo puede tomar determinados valores y es descrito mediante una ecuación en diferencias con coeficientes constantes: 

\begin{equation}
	\sum_{i=0}^{N}a_iy[n - i] = \sum_{k=0}^M b_k x[n - k] 
\end{equation}

Esta se representan con una secuencia de números denominados muestras, una muestra de una se\~nal o secuencia se denota por $x[n]$ siendo $n$ enteros en el intervalo $ - \infty < n < \infty$ y solo está definida por números enteros. En muchas aplicaciones, la secuencia discreta se obtiene muestreando una señal continua a intervalos de tiempo regulares. Si todos los valores de la secuencia $x[n]$ son reales se dice que la secuencia es real, en otro caso se dice que se trata de una secuencia compleja.

\subsubsection{Variables de estado discreto}

Los métodos de variables de estado para el análisis y diseño de sistemas de tiempo continuo pueden extenderse al análisis y diseño de sistemas de tiempo discreto. El diseño de sistemas de tiempo discreto se implementa usando la función de transferencia en z. Se observa que, mientras tratamos con sistemas de tiempo discreto, a menudo encontramos dos situaciones diferentes. Los sistemas que son completamente discretos con respecto al tiempo en el sentido de que reciben y entregan sólo señales discretas (i. e. sistemas basados en computadoras digitales) y los sistemas con componentes de tiempo continuo discretizados como consecuencia de operaciones de muestreo.
Para un sistema lineal e invariante en el tiempo discreto de n$-$ésimo orden se representa por:

\begin{equation}
	x(k + 1) = A x(k) + B u (t)
\end{equation}

Esta ecuación en diferencias de primer orden representan la dinámica del sistema, en tiempo discreto, siendo $x(k)$ el vector de estado de dimensiones $n \times I$.

\begin{equation}
	y(k) = C x(k) + D u (k)
\end{equation}

La ecuación de salida es simplentente una ecuación algebraica. 

\subsubsection{Polinomio característico}

Para cada matriz $A$ de orden $m$ se tiene que en $det(A - \lambda I)$ es un polinomio de grado $m$ que se llama polinomio característico de $A$ y se denota por $pA(\lambda)$. La ecuación $det(A - \lambda I) = 0$ se llama ecuación característica de $A$, donde se denota $I$ como la matriz indentidad. Las relaciones que ligan las entradas de una matriz con los coeficientes del polinomio característico son muy complicadas. No obstante, ciertos coeficientes de dicho polinomio son conocidos.

\subsubsection{Función de transferencia y la transformada z}

El análisis de los sistemas lineales discretos se ve facilitado por el uso de una herramienta matemática denominada transformada $Z$, la cual se define a partir de una secuencia de números $x\left( k \right)$ del modo siguiente:

\begin{equation}
	Z\left[ x \left(k\right) \right] = X\left(z)\right] = \sum_{k=0}^\infty x \left(k)\right)z^{-k}
\end{equation}

La transformada $Z$ definida por la ecuación anterior se denomina unilateral, ya que se considera que $x\left( k \right)$ sólo está definido para $k > 0$, para el caso que esté definido desde $ - \infty $ se denominada bilateral. La transformada $Z$ aplicada a sistemas de tiempo discreto guarda una gran analogía con la transformada de Laplace de aplicación a los sistemas de tiempo continuo. Por lo que la función de tranferencia en tiempo discreto tiene igual una gran similitud:
\begin{equation}
	G\left(z \right) = \frac{Z\left[y\left(k \right)\right]}{Z\left[u\left(k \right)\right]} = \frac{Y\left(z \right)}{X \left(z \right)}
\end{equation} 

\subsubsection{Estabilidad discreta}

Al igual que en el caso continuo, un sistema discreto es estable si se presenta un cambio pequeño en las entradas, un sistema estable presentará modificaciones pequeñas en su respuesta. La estabilidad se puede determinar a partir de la localizacion de los polos de lazo cerrado en el plano z. EL sistema es estable si los polos de las raíces de la ecuación característica quedan localizadas dentro del círculo unitario en el plano Z. Por el contrario, si un par de polos conjugados complejos están fuera el círculo unitario o polos múltiples el sistema es inestable, pero si al menos un polo  está ubicado en $z=1$ o $z = -1$, el sistema es marginalmente estable.

\section{Dinámica}
\subsection{Movimiento translacional}
Para modelar el comportamiento de los cuerpos en movimiento es necesario aplicar las ecuaciones de la mecánica clásica. Un cuerpo rígido ubicado en el espacio posee 6 grados de libertad (cantidad mínima de parámetros necesarios para describir su configuración), la posición espacial de su centro de masa, y su orientación. La segunda ley de Newton nos permite calcular la traslación del objeto, mientras que las ecuaciones de Euler nos permiten calcular su orientación.

Para el sistema de coordenadas cartesiano, se define el vector de posición $\vec{r}$ como:

\begin{equation}
\vec{r }= [r_x,r_y,r_z]
\end{equation}
El vector de velocidad $\vec{v}$ como:
\begin{equation}
\vec{v} = \frac{d}{dt}\vec{r}
\end{equation}
Y el vector de aceleración $\vec{a}$ como:
\begin{equation}
\vec{a} = \frac{d}{dt}\vec{v}
\end{equation}
En la mecánica newtoniana se define la cantidad de movimiento como el producto de la masa por la velocidad: \begin{equation}
\vec{P} = m\vec{v}
\end{equation}
El momento lineal obedece a la ley de conservación, lo cual significa que el momento lineal de todo sistema cerrado permanece constante en el tiempo. 

La segunda ley de Newton establece que la razón de cambio del momento lineal de un cuerpo es igual a la suma de las fuerzas aplicadas a este. Para un objeto de masa constante, esto resulta en la ecuación:
\begin{equation}
\sum{\vec{F}} = \frac{d}{dt}\vec{P} = m\vec{a}
\end{equation}

\subsection{Movimiento rotacional}
\subsubsection{Momento de torsión}
%\todo[inline]{Se introduce la definición de torque}
Cuando se aplica una fuerza en algún punto de un cuerpo rígido, dicho cuerpo tiende a realizar un movimiento de rotación en torno a algún eje, la propiedad de la fuerza aplicada para hacer girar al cuerpo se mide con una magnitud física denominada torque (momento de torsión). El momento de torsión es la capacidad de dicha fuerza para producir una rotación alrededor de un punto.

\begin{equation}
\vec{M}_o = \vec{r}_o \times \vec{F} 
\end{equation}

\subsubsection{Momento angular}
El momento angular de un sistema de partículas respecto a un punto $o$ se define como:
\begin{equation}
	\vec{H}_o = \sum{ \vec{r}_o \times \vec{P}}
\end{equation}
Para un sólido rígido tenemos:
\begin{equation}
\label{eq:fisica:momento_angular_integral}
 \vec{H_o} = \int_m{\vec{r_o} \times \vec{v}dm} = \int_m{\vec{r_o} \times \vec{\omega} \times \vec{r_o} dm} 
\end{equation}
Desarrollando la ecuación \ref{eq:fisica:momento_angular_integral} para un sistema cartesiano, tenemos que:
\begin{equation}
	H_G = (I_{xx}\omega_x - I_{xy}\omega_y - I_{xz}\omega_z)i + (- I_{yx}\omega_x + I_{yy}\omega_y - I_{yz}\omega_z)j + (- I_{zx}\omega_x + I_{zy}\omega_y + I_{zz}\omega_z)k
\end{equation}
Donde los términos $I_{xx}, I_{yy}, I_{zz}$, comúnmente conocidos como momentos principales, se definen como:
\begin{equation}
	I_{xx} = \int_m (y^{'2} + z^{'2})dm, I_{yy} = \int_m (x^{'2} + z^{'2})dm, I_{zz} = \int_m (x^{'2} + y^{'2})dm,  
\end{equation}
Y los términos $I_{xy}, I_{xz} y I_{yz}$, conocidos como productos de inercia, se definen como:
\begin{equation}
	I_{xy} = I_{yx} = \int_m x^{'}y^{'}dm, I_{xz}=I_{zx}= \int_m x^{'} z^{'} dm, I_{yz}=I_{zy}= \int_m y^{'} z^{'} dm,     
\end{equation}
La ecuación del momento angular puede ser expresada de forma matricial como:
\begin{equation}
	\begin{pmatrix}
	H_{Gx}\\
	H_{Gy}\\
	H_{Gz}
	\end{pmatrix} = \begin{pmatrix}
	I_{xx} & -I_{xy} & -I_{xz}\\
	-I_{yx} & I_{yy} & -I_{yz}\\
	-I_{zx} & -I_{yx} & I_{zz}
	\end{pmatrix} \begin{pmatrix}
	\omega_x\\
	\omega_y\\
	\omega_z
	\end{pmatrix}
\end{equation}

O bien, en su forma compacta como:

\begin{equation}
	\vec{H}_G = [I_G] \vec{\omega}
\end{equation}
Donde a $[I_G]$ se le conoce como tensor de inercia, este refleja la distribución de masa de un cuerpo en rotación respecto a un eje de giro y es una medida de su inercia rotacional. El momento de inercia solo depende de la geometría del cuerpo y de la posición del eje de giro.

A menos que la velocidad angular $\omega$ sea un eigen vector de la matriz de inercia, el momento angular y la velocidad angular no estarán en la misma dirección. Además que, los momentos de inercia dependen de la distribución de la masa con respecto a los ejes coordenados si el objeto rota.

El momento angular de un sistema de partículas se conserva si ningún par externo es aplicado, esto es, la razón de cambio del momento angular de un cuerpo es la suma de los momentos de torsión aplicados sobre este.

\begin{equation}
	\sum{\vec{M}} = \dot{\vec{H}} = \dot{[I]}\vec{\omega} + [I]\dot{\vec{\omega}}
	\label{eq:derivada-del-momento-angular}
\end{equation}
A diferencia de la segunda ley de Newton, donde la masa permanece constante, los momentos de la matriz de inercia varían según la posición y orientación del objeto. Como ya se ha mencionado, el problema reside en tener que recalcular estos momentos, por lo que comúnmente se opta por cambiar a un sistema de referencia que se mueva con el objeto.

Para calcular la derivada de un vector $\vec{V}$ en un marco de referencia $xyz$ que gira con una velocidad angular $\vec{\Omega}$, se requiere aplicar el teorema de Coriolis.
\begin{equation}
	\dot{\vec{V}} = (\dot{\vec{V}})_{xyz}  + \vec{\Omega} \times (\vec{V})
\end{equation}
Gracias a esto, podemos considerar a $[I]$ como constante y por ende, la ecuación \ref{eq:derivada-del-momento-angular} se convierte en:
\begin{equation}
	\sum{\vec{M}} = [I] \dot{\vec{\omega}} + \vec{\Omega} \times \vec{H}
	\label{eq:derivada-inercia-coriolis}
\end{equation}
Para el caso especial donde la velocidad angular del objeto $\vec{\omega}$ es la misma que la velocidad angular del marco móvil $\vec{\Omega}$ y los ejes del marco móvil coinciden con los ejes principales del objeto, entonces podemos expandir la ecuación \ref{eq:derivada-inercia-coriolis} en la forma:
 
\begin{equation} \label{eq:fisica:eq_euler_1}
	M_x = I_{xx}\dot{\omega}_x - (I_{yy} - I_{zz}) \omega_y\omega_z
\end{equation} 
\begin{equation} \label{eq:fisica:eq_euler_2}
	M_y = I_{yy}\dot{\omega}_y - (I_{zz} - I_{xx}) \omega_z\omega_x
\end{equation} 
\begin{equation} \label{eq:fisica:eq_euler_3}
	M_z = I_{zz}\dot{\omega}_z - (I_{xx} - I_{yy}) \omega_x\omega_y
\end{equation} 
Este conjunto de ecuaciones se les conoce como ecuaciones de Euler, y nos proveen de un medio para calcular el movimiento de un cuerpo rígido en tres dimensions. Sin embargo, estas ecuaciones presentan problemas para encontrar sus soluciones ya que poseen productos de $\omega$ y esto representa no linealidades. El otro problema consiste en definir la forma en la que se represetará la rotación del marco móvil.

\subsubsection{Ángulos de Euler} \label{sec:angulos-euler}
Para determinar la posición del marco móvil se utilizan un conjunto de rotaciones consecutivas, al conjunto de ángulos que definen estas rotaciones se les conoce como ángulos de Euler. Existen 12 secuencias distintas de rotaciones entre las que más destacan la rotación ZXZ (ángulos de Euler clásicos), y la rotación ZXY (ángulos de Tyat-Bryan), estos últimos son usualmente usados para la navegación.

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[width=10cm, height=4cm]{images/Capitulo_1/secuencia_angulos_euler}
	\caption{\textit{Secuencia de rotaciones ZYX.}}
\end{center}
\end{figure}

Usando las matrices de rotaciones de magnitud $\psi$,$\theta$ y $\phi$ para representar la rotaciones Z,Y,X respectivamente, obtenemos la transformación $T$.
\begin{equation}
	T_1^B (\phi,\theta,\psi)= \begin{pmatrix}
	1 & 0 & 0\\
	0 & cos(\phi) & sin(\phi)\\
	0 & -sin(\phi) & cos(\phi)
	\end{pmatrix} \begin{pmatrix}
	cos(\theta) & o & -sin(\theta)\\
	0 & 1 & 0\\
	sin(\theta) & 0 & cos(\theta)
	\end{pmatrix} \begin{pmatrix}
	cos(\psi) & sin(\psi) & 0\\
	-sin(\psi) & cos(\psi) & 0\\
	0 & 0 & 1
	\end{pmatrix}
	\label{eq:matrices-angulos-euler}			
\end{equation}
De forma compacta:
\begin{equation}
	T_1^B (\phi,\theta,\psi)= {T^B_2} (\phi) {T_1}^2 (\theta) {T_l}^1 (\psi) 	
\end{equation}
Lo que se busca es encontrar una relación entre la velocidad angular del marco móvil
\begin{equation}
	\Omega_B = \begin{pmatrix}
	\Omega_x\\  
	\Omega_y\\  
	\Omega_z
	\end{pmatrix}_B
\end{equation}
y el conjunto de ángulos de Euler.
\begin{equation}
	\Theta = \begin{pmatrix}
	\phi\\
	\theta\\
	\psi
	\end{pmatrix}
\end{equation}
Debido a que cada rotación ocurre sobre su propio eje es necesario representar las velocidades angulares como:
%%tercera parte
\begin{equation}
	\begin{pmatrix}
	\Omega_x\\
	\Omega_y\\
	\Omega_z
	\end{pmatrix} = I_3 \begin{pmatrix}
	\dot{\phi}\\
	0\\
	0
	\end{pmatrix} + {T^B}_2 \begin{pmatrix}
	0\\
	\dot{\theta}\\
	0
	\end{pmatrix} + {T^B}_2{T^2}_1 \begin{pmatrix}
	0\\
	0\\
	\dot{\psi}
	\end{pmatrix}
	\label{eq:velocidad-angular-euler}
\end{equation}
A causa de cómo están definidas la rotaciones, la dirección del vector $\vec{\phi}$ siempre coincide con el eje $x$, si expandimos la ecuación \ref{eq:velocidad-angular-euler} y reagrupamos términos obtenemos la matriz de transformación $Q^B$:

\begin{equation}
	\begin{pmatrix}
	\Omega_x\\
	\Omega_y\\
	\Omega_z
	\end{pmatrix} = \begin{pmatrix}
	1 & 0 & -sin(\theta)\\ 
	0 & cos(\phi) & sin(\phi)cos(\theta)\\
	0 & - sin(\phi) & cos(\phi)cos(\theta)
	\end{pmatrix} \begin{pmatrix}
	\dot{\phi}\\
	\dot{\theta}\\
	\dot{\psi}
	\end{pmatrix} = {Q^B} \Theta
\end{equation}
Finalmente se calcula la transformada inversa (debemos tener en cuenta que $[(Q)^{-1} \neq (Q)^T]$):
\begin{equation}
	\begin{pmatrix}
	\dot{\phi}\\
	\dot{\theta}\\
	\dot{\psi}
	\end{pmatrix} = \begin{pmatrix}
	1 & sin(\phi)tan(\theta) & cos(\theta)tan(\theta)\\ 
	0 & cos(\phi) & -sin(\phi)\\
	0 & - sin(\phi)sec(\theta) & cos(\phi)sec(\theta)
	\end{pmatrix} \begin{pmatrix}
	\Omega_x\\
	\Omega_y\\
	\Omega_z
	\end{pmatrix} = (Q^B)^{-1} \Omega_B
\end{equation}

Nótese que matriz ${Q_B^l}$ se indetermina para valores de $\theta = \pm\pi/2$. Para todos los juegos de ángulos de Euler existen puntos donde la matriz inversa se indetermina, por eso es importante la correcta selección del juego de ángulos.

\pagebreak
\section{Control} \label{sec:control}

\subsection{Linealización}

Cuando modelamos sistemas, es común la aparición de sistemas no lineales, y encontramos el problema de que toda la teoría presentada sobre el control esta centrada en sistemas lineales. En lugar de desarrollar una teoría separada para su manejo, se presenta un método para aproximar un sistema no lineal en uno lineal.
\begin{equation}
	\label{eq:control:seriesdetaylor}
	f(x) = f(x_0) + f'(x_0)x +\frac{ f''(x_0)}{2!}x^2 ... 
\end{equation}
\begin{equation}
	\label{eq:control:seriesdetaylor-approx}
	f(x) \approx f(x_0) + f'(x_0)x 
\end{equation}
Considérese la expansión en series de Taylor (\ref{eq:control:seriesdetaylor}). Entre más términos usemos en la expansión más se aproximará a la función original, sin embargo, los primeros dos términos son suficientes con la condición de que no nos alejemos demasiado del punto $x_0$. También tiene que tenerse en cuenta que el término $f(x_0)$ rompe con el principio de homogeneidad, por lo que a \ref{eq:control:seriesdetaylor-approx} tampoco se le puede considerar una función lineal.

\begin{equation}
	\label{eq:control:nolineal}
	\dot{x} =  f(x,u)
\end{equation}
Considérese el sistema no lineal \ref{eq:control:nolineal}, donde $f$ es un mapeo de $R^{n} \times R^{m} \to R^{n}$. En caso que la función $f$ evaluara cero, el sistema  permanecería sin cambios. Entonces se define un punto de equilibrio como un conjunto de valores $\bar{x}$, $\bar{u}$, donde se cumple que:
\begin{equation}
	f(\bar{x},\bar{u}) = 0_n
\end{equation}
Ahora que se tiene un punto de operación, se miden las desviaciones de $x$ y $u$, estas serán las nuevas entradas del sistema. Luego entonces se definen las variables de desviación:
\begin{equation}
\begin{aligned}
	\delta_x(t) := x(t) - \bar{x}\\
	\delta_u(t) := u(t) - \bar{u}
\end{aligned}
\end{equation}
Realizando el cambio de variable, y aplicando la aproximación (\ref{eq:control:seriesdetaylor-approx}), se tiene la nueva ecuación en variables de estado:
\begin{equation}
	\dot{\delta_x} = A \delta_x  + B \delta_u
\end{equation}
Nótese que debido al orden multivariable del sistema, lo que en la ecuación \ref{eq:control:seriesdetaylor-approx} es una derivada simple, en la ecuación \ref{eq:control:jacobiano} son jacobianos o matrices con derivadas parciales.
\begin{equation}
\label{eq:control:jacobiano}
	A := \frac{\partial f}{\partial x}\biggr\rvert_{\substack{x =\bar{x} \\ u = \bar{u}}}\ \ \ \ \ \ \ \ B := \frac{\partial f}{\partial u}\biggr\rvert_{\substack{x =\bar{x} \\ u = \bar{u}}}
\end{equation}

\subsection{Controlabilidad}
Se dice que un sistema es controlable si se puede trasferir desde cualquier estado inicial $x(t_0)$ a cualquier otro estado mediante un vector de control sin restricciones en un intevalo de tiempo finito.\\
Para un sistema de la forma:
\begin{equation}
	\label{eq:control:sistema-lti}
	\dot{x} = Ax + Bu
\end{equation}
\begin{equation}
	\label{eq:control:salida}
	y=Cx + Du
\end{equation}
Se define la matriz de controlabilidad asociada $M_c$ como:
\begin{equation}
	\label{eq:control:matriz-de-controlabilidad}
	 M_c= [\ B\  AB\ \cdots\  A^{n-1}B\ ]
\end{equation}
El sistema es de estado completamente controlable sí y solo sí la matriz $M_c$ de $n \times nr$ tiene rango $n$, o sea, que contenga n vectores columna linealmente independientes.

\subsection{Observabilidad} \label{sec:observavilidad}
Para un sistema descrito por las ecuaciones \ref{eq:control:sistema-lti} y \ref{eq:control:salida}, se dice que es completamente observable si el estado $x(t_0)$ se puede determinar a partir de las observaciones de $y(t)$ durante un intervalo de tiempo finito $t_0 < t < t_1$. Por tanto, el sistema es completamente obsevable si todas la transiciones del estado afectan eventualmente a todos los elementos del vector de salida. El concepto de observabilidad es útil al resolver el problema de reconstruir variables de estado no medibles a partir de variables que sí lo son.\\
Se define la matriz de observabilidad $M_o$ como:
\begin{equation}
	\label{eq:control:observabilidad}
	M_o = 
	\begin{pmatrix}
	C\\
	CA\\
	\vdots\\
	CA^{n-1}
	\end{pmatrix}
\end{equation}
El sistema descrito por las ecuaciones es completamente obsevable sí y solo sí la matriz ${M_o}^T$ es de rango n ó $M_o$ tiene n vectores fila linealmente independientes.

\subsection{Control retroalimentado}
En esta sección se presenta un método de diseño conocido comúnmente como técnicas de ubicación o de asignación de polos. Se supondrá que todas las variables de estado son medibles y que están disponibles para su realimentación. Si el sistema considerado es de estado completamente controlable, los polos del sistema en lazo cerrado se pueden colocar en cualquier posición deseada mediante una realimentación del estado a través de una matriz de ganancia adecuada.

La técnica de diseño empieza con la determinación de los polos en lazo cerrado deseados a partir de las respuesta transitoria y/o las especificaciones de la respuesta en frecuencia, tales como velocidad, razón de amortiguamiento, o ancho de banda, al igual que los requisitos en estado estacionario.

En lugar de especificar sólo los polos dominantes en lazo cerrado (enfoque del diseño por convención), en el enfoque actual de asignación de polos, se especifican todos los polos en lazo cerrado. Sin embargo, hay un costo asociado con colocar todo los polos en lazo cerrado, porque hacerlo requiere tener buenas medidas de todas las variables, o bien incluir un obsevador de estado en el sistema. También existe un requisito por parte del sistema para que los polos en lazo cerrado se puedan situar en posiciones elegidas de forma arbitraria. La exigencia es que el sistema sea de estado completamente controlable.
\subsubsection{Controlador de estados}
Consideremos el esquema de control de la figura \ref{fig:control:control-retroalimentado}, en este esquema de control conocida como retrolimentación de estado completo, se usa como entrada el producto de vector de estados $x$ y la matriz de ganancias $K$ de manera que:
\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[height=4cm]{images/Capitulo_1/control_retroalimentado}
	\caption{\textit{Esquema de control retroalimentado.}}
	\label{fig:control:control-retroalimentado}
\end{center}
\end{figure}
\begin{equation}
	u = -Kx
\end{equation}
Sustituyendo esta nueva entrada en la ecuación \ref{eq:control:sistema-lti} obtenemos:
\begin{equation}
	\dot{x} = (A- BK)x = \tilde{A}x
\end{equation}
Esta nueva ecuación tiene una dinámica establecida por los polos de la matriz $\tilde{A}$. Luego entonces con la correcta selección de la matriz $K$ podemos cambiar de manera arbitraria la dinámica del sistema, siempre y cuando, este sea completamente controlable.

Exiten varios métodos para calcular la matriz $K$ entre los que destacan el método de Kalman y el método de Ackerman. Para el caso de sistemas con una sola entrada existen soluciones únicas para esta matriz, sin embargo, para sistemas con múltiples entradas existen infinita cantidad de soluciones. Por tanto, el método de Kalman y Ackerman no funcionan para estos últimos.

Debido a las infinitas soluciones, se necesitan restricciones adicionales para obtener soluciones concretas. Un método que resulta robusto es el desarrollado por Kautsky et al. en 1985, donde se minimiza la sensitivdad del sistema a las perturbaciones. Este método es el que implementa el comando 'place' de Matlab.
\subsubsection{Observador de estados}
Un observador de estado estima las variables de estado basándose en las mediciones de las variables de salida y de control. El concepto de obsevabilidad juega un papel importante.

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[height=4cm]{images/Capitulo_1/observador_estados}
	\caption{\textit{Observador de estados.}}
	\label{fig:control:diagrama-observador-estados}
\end{center}
\end{figure}

En el análisis de los observadores de estado que se presenta a continuación, se utilizará la notación $\tilde{x}$ para designar el vector de estado observado. En muchos casos prácticos, el vector de estado observado $\tilde{x}$ se usa en la realimentación del estado para generar el vector de control deseado.

Observador de estado. Un observador de estado estima las variables de estado basándose en las mediciones de las variables de salida y de control. Por ende, el concepto de observabilidad analizado en \ref{sec:observavilidad} juega un papel importante. Como se verá más adelante, los observadores de estado pueden diseñarse sí y solo sí se satisface la condición de observabilidad.

En el análisis de los observadores de estado que a continuación se presenta, se utilizará la notación $\tilde{x}$ para designar el vector de estado observado. En muchos casos prácticos, el vector de estado observado $\tilde{x}$ se usa en la realimentación del estado para generar el vector de control deseado.

El observador es un subsistema para reconstruir el vector de estado de la planta. El modelo matemático del observador es, básicamente, el mismo que el de la planta salvo que se incluye un término adicional que contiene el error de estimación para compensar las imprecisiones en las matrices A y B, y la falta del error inicial. El error de estimación (error de observación) consiste en la diferencia entre la salida media y la salida estimada, mientras que el error inicial es la diferencia entre el estado inicial y el estado estimado inicial. De esta forma, se define el modelo matemático del observador como:

\begin{equation}
	\dot{\tilde{x}} = A\tilde{x} + Bu + K_e(y - C\tilde{x}) = (A-K_eC)\tilde{x}+Bu+K_ey
	\label{eq:control:sistema-lti-tilde}
\end{equation}

Donde $\tilde{x}$ es el estado estimado y $C \tilde{x}$ es la salida estimada. Las entradas al observador son la salida y la entrada de control $u$. La matriz $K_o$, que se llama matriz de gananacia del observador, es una matriz de ponderación al término de corrección que involucra la diferencia entre la salida media y la salida estimada  $C \tilde{x}$. Este término corrige de forma continua la salida del modelo y mejora el comportamiento del observador. La figura \ref{fig:control:diagrama-observador-estados} muestra el diagrama de bloques del observador de estados de orden completo del sistema.

Para obtener la ecuación de error del observador se resta la ecuación \ref{eq:control:sistema-lti-tilde} de la ecuación \ref{eq:control:sistema-lti} y se obtiene:

\begin{equation}
	\dot{x} - \dot{\tilde{x}} = Ax - A\tilde{x} - K_e(Cx-C\tilde{x}) = (A - K_eC)(x - \dot{\tilde{x}})
\end{equation}
Se define la diferencia entre $x$ y $\tilde{x}$ como el vector de error $e$, o bien:
\begin{equation}
	e = x -\tilde{x}
\end{equation}
Haciendo el cambio de variable, la ecuación se convierte en:
\begin{equation}
	\dot{e} = (A - K_eC)e
\end{equation}

\subsection{Control integral continuo}
%\todo[inline]{Se explican las limitacion del control retroalimentado}
%\todo[inline]{Se se explica la idea del servocontrol}
%\todo[inline]{formulas}

El principio básico de un servosistema es insertar un integrador en el camino directo entre el comparador de error y la planta, tal y como se muestra en la figura \ref{fig:control:esquema-de-control-integral}. A partir del diagrama se obtiene:

\begin{equation}
	\dot{x} = Ax + Bu
\end{equation}
\begin{equation}
	y = Cx
\end{equation}
\begin{equation}
	u =  -Kx +K_i\xi
\end{equation}
\begin{equation}
	\dot{\xi} =  r - y = r - Cx
\end{equation}

\begin{figure}[htb]
\begin{center}
\centering
	\includegraphics[height=4cm]{images/Capitulo_1/control_integral}
	\caption{\textit{Esquema de control integral.}}
	\label{fig:control:esquema-de-control-integral}
\end{center}
\end{figure}

Se supone que la planta obtenida es de estado completamente controlable. La función de transferencia se obtiene mediante:
\begin{equation}
	\begin{pmatrix}
	\dot{x}\\
	\dot{\xi}
	\end{pmatrix} = \begin{pmatrix}
	A & 0\\
	-C &0
	\end{pmatrix} \begin{pmatrix}
	x(t)\\
	\xi(t)
	\end{pmatrix} + \begin{pmatrix}
	B\\
	0
	\end{pmatrix}u_e(t)
\end{equation}
Se diseñará un sistema asintóticamente estable tal que se tienda respectivamente a valores constantes. Así, en estado estacionario $\xi (t) = 0$ se obtiene $y( \infty ) = r$:

\begin{equation}
	u_e(t) = - Kx_e(t) + K_i\xi_e(t)
\end{equation}
\begin{equation}
	e(t) = \begin{pmatrix}
	x_e(t)\\
	\xi_e(t)
	\end{pmatrix}
\end{equation}
\begin{equation}
	\dot{e} = [K|-K_i]
\end{equation}
\begin{equation}
	\dot{e} = (\hat{A}- \hat{B}\hat{K})e
\end{equation}
\begin{equation}
	\hat{A} = 
	\begin{pmatrix}
	A & B\\
	-C & 0
	\end{pmatrix}
\end{equation}

Si los valores propios deseados de la matriz $\hat{A}-\hat{B}\hat{K}$ (los polos en lazo cerrado deseados $\mu$) son estables, entonces la matriz de ganancias de realimentación del estado $K$ y la constante de ganancia integral $K_i$ pueden determinarse mediante el método de asiganción de polos BIBLIO Kautsky, a condición de que el sistema definido por la ecuación sea completamente controlable.

\subsection{Servocontrol discreto}

Las entradas de referencia consideradas pueden incluir pasos, rampas y otras señales discretas  persistentes, tales como sinusoides. Para una entrada escalonada, sabemos que se pueden obtener errores cero de seguimiento en estado cero. Esta idea se formaliza aquí mediante la introducción de un modelo interno de la referencia de entrada en el compensador, cuando este contiene un integrador. 
Considerando un modelo:

\begin{equation}
	x(k + 1) = Ax(k) + Bu(k) + \Gamma\omega
\end{equation}

\begin{equation}
	y(k) = Cx(k) + E\omega
\end{equation}

Donde $\omega$ es una constante de perturbación. El integrador $z(k + 1) = z(k) + r -y(k)$ al ser agregado al modelo anterior permite obtener:

\begin{equation}
	\begin{pmatrix}
		x(k + 1)\\
		z(k + 1)
	\end{pmatrix} = A \begin{pmatrix}
	x(k)\\
	z(k)
	\end{pmatrix} + Bu(k) + \begin{pmatrix}
	\Gamma \\
	-E
	\end{pmatrix} \omega + \begin{pmatrix}
	0 \\
	I_m
	\end{pmatrix}r
\end{equation}
Donde:
\begin{equation}
	A = \begin{pmatrix}
	A & 0\\
	-C & I_m
	\end{pmatrix} \hspace{2cm},\hspace{2cm} B = \begin{pmatrix}
	B\\
	0
	\end{pmatrix}
\end{equation}

Designamos $ F = [F_1\hspace{0.5cm}F_2]$ tal que $|\lambda(A + BF)| < 1$ \\

Lema: $(A,B)$ es controlable(respectivamente estabilizables) sí y solo sí:

\begin{itemize}
\item $(A,B)$ es controlable y respectivamente establizable, y
\item el rago de $\begin{pmatrix} (I_n - A) & A\\C&0 \end{pmatrix} = n + m$
\end{itemize}

Una vez asignado $F_1$ y $F_2$, se tiene:

\begin{equation}
	u(k) = F_1x(k) + F_2z(k)
\end{equation}

Para una salida retroalimentada, asumimos que $(A,C)$ es detectable y designamos un observador que estime $x$ mediante $\hat{x}$, se obtiene:

\begin{equation}
	u(k) = F_1\hat{x}(k) + F_2z(k)
\end{equation}

\subsection{Control calendarizado}
Uno de los problemas que surgen a partir de tratar de controlar un sistema no lineal usando una aproximación linealizada, es que cuando nos alejamos del punto de equilibro la diferencia entre el sistema no lineal y el linealizado puede volverse significativa, hasta el punto en que el sistema controlador-observador se vuelva inefectivo y en el peor de los casos inestable.

Para resolver este problema existen diferentes soluciones, entre las que encontramos el control calendarizado interpolante. Este esquema consiste en linealizar en diferentes puntos de equilibro dentro del espacio de operación del sistema, para obtener el conjunto de matrices $A, B$ y $C$. Además de recalcular las matrices de ganancia del controlador-observador $K, Ki$ y $Ko$. Finalmente dependiendo del estado del sistema se interpolan las matrices anteriormente calculadas para obtener el conjunto de matrices que se utilizarán en este nuevo punto de operación. 

Para asegurar la estabilidad del sistema, este debe de ser controlable y observable dentro de toda la región de operación.

\subsection{Discretización de controladores}

La discretización (digitalización) de controladores continuos es básicamente emplear métodos de discretización para el procesamiento digital de señales. Existen varios métodos para la discretización de controladores continuos, en este caso en particular se utiliza el método de la transformada bilinear (también denominada trapezoidal o de Tustin).

Este método fue desarrollado por el profesor Arnold Tustin y es una técnica de mapeo de polos y ceros de una función de tiempo continuo para un sistema de desplazamiento invariante discreto. Describe $H(z)$ de un sistema LTI, descrito por un $H (s)$ (pasa del plano  $s$ al plano $z$). La transformada bilineal se define como:
%\arrowvert_    \bracevert_ 
\begin{equation}
	H(z) = H(s) \biggr\rvert_{s = \frac{2}{t}(\frac{1 - z^{-1}}{1 + z^{-1}})} 
\end{equation}   

Toma la función $H(s)$ y todas sus variables acompañados por $s$ y sustituye los términos equivalentes en $z$. Lo que esto implica que si el sistema es controlable y es estable, al hacer la tranformación se garantiza la controlabilidad y la estabilidad en $z$.

\begin{figure}[htb]
\centering
	\includegraphics[width=0.5\textwidth]{images/Capitulo_1/mapeo_s_z}
	\caption{\textit{Tranformación de bilineal.}}
\end{figure}

\subsection{El observador de Kalman}
\subsubsection{Variables aleatorias}
Una variable aleatoria es una función que  asigna eventos posibles, cuyos valores se miden como resultado de un experimento aleatorio. Los experimentos aleatorios son aquellos que, desarrollados bajo las mismas condiciones, pueden ofrecer resultados diferentes, por ejemplo arrojar una moneda al aire o medir una temperatura. No se sabe que valor adoptará la variable hasta que sea determinada o medida, pero si se puede conocer como se distribuyen las probabilidades vinculadas a los valores posibles. Si la variable puede tomar cualquier valor en el intervalo de observación, se dice que la misma es una variable aleatoria continua. De lo contrario, si posee un conjunto numerable de valores se considera discreta.
\subsubsection{Distribuciones de probabildad}
Comenzaremos discutiendo el caso discreto por ser al que estamos más acostumbrados, después extenderemos la noción al caso continuo que será el que se aplicará al proyecto. 
Se conoce como distribución de probabilidad a una función $f(x)$ que asigna una probabilidad a cada valor/evento $X$ perteneciente a la variable aleatoria $x$. Una distribución de probabildad debe cumplir:\\

I.E. lanzar una dado.
$$
	f(x) =\{ 1/6,\ x = 1,2,3,4,5,6 \}
$$

Para el caso continuo, debido a la infinidad de valores que puede tomar la variable aleatoria, se usa el concepto de densidad de probabilidad. La función $f(x)$ es una función de densidad de probabildad para la variable aleatoria continua $X$, sí y solo sí:
\begin{enumerate}
\item $f(x) \geq 0 \ \forall\ x \epsilon R$
\item $\int_{-\infty}^{\infty} f(x)dx  = 1$
\item $P(a \leq x \leq b) = \int_{a}^{b} f(x)dx$ 
\end{enumerate}

\subsubsection{Procesos estocásticos}
Un modelo es estocástico cuando contiene al menos una variable aleatoria. En un proceso estocástico no se puede saber con certeza el estado pasado o futuro  del sistema, sin embargo podemos cuantificar la incertidumbre mediante variables aleatorias y distribuciones de probabilidad. El modelo de un sistema estocástico nos permite calcular la probabildad de cierta salida del sistema pero no valores en concreto.

En el caso del filtro de Kalman nos interesan los sistemas lineales discretos, que podrían verse como la versión estocástica del sistema LTI discreto, estos sistemas son de la forma:

\begin{equation}
x = x * tu + w
\end{equation}

Donde $w$ es la variable estocástica que modela el ruido del proceso, y $u$ es la variable aleatoria que modela el ruido en la medición.

I. e. un robot que trata de determinar su posición representada mediante la variable $x$. Si sabemos con cierta certeza que estamos en una posición representada mediante la distribución $x$ y sabemos que las llantas giran a un velocidad $u$, entonces podemos predecir que ahora estamos otra posición $x_{k+1}$. Pero debido a que el sistema no es ideal (existen imperfecciones en el camino, las llantas del robot, el arrastre del aire, entre otros factores), es posible que durante el desplazamiento existan variaciones imprevistas que afecten la trayectoria esperada en un princio del robot. Esta incertidumbre queda cuantificada en el ruido del proceso $w$. Si suponemos que ambas distribuciones son gaussianas, entonces tenemos que la nueva distribución $x_t$ tiene la forma de la figura \ref{fig:distribucion-gaussiana}.

\begin{figure}[htb]
\centering
	\includegraphics[width=0.5\textwidth]{images/Capitulo_1/gaussiana_distribucion}
	\caption{\textit{Distribución probabilística gaussiana.}}
	\label{fig:distribucion-gaussiana}
\end{figure}

Esta distribución tiene una mayor varianza, o sea, se tiene menos certeza sobre la posición del robot antes de realizar el movimiento.

%\todo[inline]{Se hablad sobre conceptos de probabildiad, como el valor esperado, la correlacion, la varianza}
%\todo[inline]{Se describe la ley de bayes}
%\todo[inline]{la ley de probabilidad total}
\subsubsection{El filtro de Kalman}

El filtro de Kalman es un algoritmo que se basa en el modelo de espacio de estados de un sistema para estimar el estado futuro y la salida futura realizando un filtrado óptimo (el filtro de Kalman es \'optimo respecto a casi cualquier criterio  que tenga sentido) a la se\~nal de salida, y dependiendo del retraso de las muestras que se le ingresan puede cumplir la función de estimador de parámetros o únicamente de filtro, pero en ambos casos elimina ruido. Estas ecuaciones son ampliamente utilizadas ya que incluyen probabilidades estadísticas, esto debido a que se toma en cuenta la aleatoriedad tanto de la señal como del ruido. Asimismo, hace uso del conocimiento del sistema y de la dinámica de los  instrumentos de medición, describe estadísticamente los errores de la medic\'ion y la incertidumbre de los modelos dinámicos. 
A diferencia de otros tipos de filtros, este no requiere de una frecuencia de corte específica debido a que se basa en la característica del ruido, permitiendo de esta manera filtrar en todo el espectro de frecuencias. 
El filtro de Kalman es esencialmente una serie de ecuaciones matemáticas que implementan un estimador tipo predictor $-$ corrector que es óptimo en el sentido que minimiza el error estimado de la covarianza cuando algunas condiciones son dadas. La covarianza es un valor que indica el grado de variación conjunta de dos variables aleatorias respecto a sus medias. Es el dato básico para determinar si existe una dependencia entre ambas variables y además es el dato necesario para estimar otros par\'ametros b\'asicos. A continuaci\'on se muestra el algoritmo reiterativo  desarrollado por Rodolf Kalman.% cabe destacar que este algoritmo re$-$iterativo eventualmente converge a un error minimo entre el valor real de la variable y el valor predicido:

Se inicia con una estimaci\'on previa a la mediaci\'on con su respectivo error de covarianza, y esta es tomada en cuenta en el cálculo de la ganacia de Kalman: 
\begin{equation}
	K_k = P^-_k H^T (H_k P^-_k H^T_k +R_k)^{-1}
\end{equation}

Se actualiza la estimaci\'on con la medici\'on y se obtiene un resultado:
\begin{equation}
	\hat{X_k} = \hat{X}^-_k + K_k (Z_k - H_k \hat{X}^-_k)
\end{equation}

Se calcula la covarianza del error para la estimación actualizada:

\begin{equation}
	P_k = (l - K_k H_k) P^-_k
\end{equation}

Teniendo la estimaci\'on actualizada, se hace la nueva proyeccci\'on a futuro:

\begin{equation}
	\hat{X}^-_{k+1} = \phi_k \hat{X}_k
\end{equation}

\begin{equation}
	P^-_{k+1} = \phi_k P_k \phi^T_k + Q_k
\end{equation}

Y así, la nueva proyecci\'on pasa  a hacer la estimación actual repitiendo el proceso, en esencia el filtro Kalman realiza la predicci\'on y al final lo corrige. 
\newpage

\section{Diseño de ingeniería }

Comúnmente se asocia el diseño a una actividad relacionada con la estética de los objetos o una mejora en la apariencia de algún producto. Sin embargo, en ingeniería implica una serie de conocimientos, métodos y herramientas más complejos para llevar a cabo esta actividad, entre los que podemos destacar \cite{cite_1_2017}:

\begin{itemize}
\item Definir los requerimientos y las necesidades de los usuarios.
\item Determinar la competencia en el mercado.
\item Definir las nuevas funciones del producto.
\item Cálculo de parámetros y realización de modelos.
\item Fabricación de prototipos.
\item Evaluación de los costos. 
\item Definir la apariencia y mejora de la ergonomía. 
\end{itemize}

Podemos definir el diseño de ingeniería como toda actividad necesaria para definir soluciones a problemas específicos que no se han podido resolver con anterioridad, o nuevas soluciones a problemas resueltos de formas alternas, donde el ingeniero aplica conocimientos científicos y técnicos para asegurar que el producto satisfaga los requerimientos y necesidades del mercado, cumpliendo con las especificaciones de manufactura y ensamble en los tiempos y costos establecidos. Este proceso de diseño no se da por terminado hasta que el producto cumpla de manera formal con los estándares de calidad, fiabilidad y con los costos y rendimiento esperados \cite{cite_1_2017}. 

El diseño de ingeniería es un proceso secuencial e iterativo, donde en cada una de sus etapas se considera la información y el conocimiento adquirido a lo largo del proceso de diseño. De acuerdo con Robert Norton, este proceso puede dividirse en diez etapas \cite{cite_2_2017}:

\newpage

\begin{enumerate}
\item Identificación de la necesidad: definir las necesidades y características principales del producto.
\item Investigación preliminar: se realiza una documentación preliminar para el diseño.
\item Planteamiento del objetivo: definición de los objetivos y metas que se deben cumplir.
\item Funcionalidad: definición de las funciones principales del producto.
\item Planteamiento de posibles soluciones. 
\item Análisis: implementación de técnicas analíticas para determinar la factibilidad.
\item Selección: selección del diseño conceptual.
\item Diseño detallado: determinación a detalle de las características del producto.
\item Prototipos y pruebas: construcción de modelos físicos para verificar el funcionamiento. 
\item Producción: comienzo de la producción del producto una vez validado el diseño. 
\end{enumerate}

\subsection{Diseño mecatrónico}
El diseño mecatrónico trabaja sobre un enfoque concurrente, lo que implica la participación de todas las áreas de la mecatrónica (mecánica, eléctrica, informática, etc.) a lo largo del proceso de diseño. Comenzando con el diseño básico, y avanzando a través de la fase de producción, el diseño mecatrónico optimiza los parámetros en cada fase para obtener un producto de calidad en menor tiempo.

En el diseño de un producto mecatrónico, es necesario que el conocimiento y la información requerida se coordinen entre los diferentes grupos de trabajo, lo que se conoce como ingeniería concurrente. La ingeniería concurrente es un enfoque de diseño en el que el diseño y la fabricación de un producto se fusionan. Esto fue influenciado en parte por el reconocimiento de que muchos de los altos costos en la fabricación se deciden en la etapa de diseño. 

\newpage

Sin embargo, el diseño mecatrónico se refiere no sólo a la manufactura de productos en sí, sino también al mantenimiento de los mismos dentro de un área denominada diseño del ciclo de vida del producto. 

El \textit{ciclo de vida} reúne toda una serie de actividades que van desde la integración del diseño, ingeniería y fabricación, logística, almacenamiento y distribución, clientes y proveedores, ventas, actividades de marketing y la administración financiera y de control.

\begin{figure}[htb]
\centering
	\includegraphics[width=\textwidth]{images/Capitulo_1/Ciclo_Vida}
	\caption{\textit{Diagrama del ciclo de vida de un producto \cite{cite_1_2017}.}}
\end{figure}

\newpage

El proceso de diseño mecatrónico puede simplificarse en tres fases: modelado y simulación, creación del prototipo y desarrollo del ciclo de vida \cite{cite_3_2017}. 

\begin{figure}[htb]
\centering
	\includegraphics[width=\textwidth]{images/Capitulo_1/Disen_mecatronico}
	\caption{\textit{Fases del diseño mecatrónico \cite{cite_1_2017}.}}
\end{figure}

Debido a su modularidad, los sistemas mecatrónicos son adecuados para aplicaciones que requieren reconfiguraciones. Dichos productos pueden ser reconfigurados durante la fase de diseño mediante la sustitución de varios módulos del subsistema o durante el ciclo de vida útil de los productos.

\newpage

A continuación, se presenta un diagrama más detallado del proceso de diseño mecatrónico, donde se muestran además algunas de las herramientas y métodos que se utilizan durante cada una de las etapas:

\begin{figure}[htb]
\centering
	\includegraphics[width=\textwidth]{images/Capitulo_1/Mecatronico}
	\caption{\textit{Diagrama extendido del proceso de diseño mecatrónico \cite{cite_1_2017}.}}
\end{figure}

\subsection{Especificaciones de diseño del producto (PDS)}
Dado que el proceso de diseño debe partir de las restricciones del producto, debe utilizarse una herramienta que documente estas características. A este documento se le conoce como PDS (Product Design Specifications por sus siglas en inglés).

Es considerada una herramienta técnico-administrativa que permite al equipo de diseño describir a detalle los requerimientos y necesidades con las que debe cumplir el producto. Tiene como objetivo reducir las posibles dificultades del proyecto y reducir considerablemente el tiempo de cada una de las etapas de desarrollo, debido en gran parte al reconocimiento e interpretación de las necesidades del cliente. 

En resumen, es un documento técnico para el equipo de diseño que describe qué es lo que el producto debe hacer. Este debe cumplir con dos principales tareas \cite{cite_4_2017}:

\begin{itemize}
\item Definir el área del problema en función de las necesidades del cliente. 
\item Formular exactamente el problema, definiendo todas las funciones y restricciones. 
\end{itemize}

Este documento permanece en constante evolución a lo largo del desarrollo del proyecto, esto gracias a la información adquirida a través de las etapas del proceso de diseño, a las recomendaciones o especificaciones del cliente y a las modificaciones que los diseñadores consideren necesarias. Los elementos del PDS dependen del problema de diseño a resolver, por lo que no existe un formato específico para documentar dichas especificaciones. Sin embargo, deben considerarse ciertas características para elaborar el PDS, las cuales se presentan en la siguiente tabla \cite{cite_4_2017}: 

\begin{figure}[htb]
\centering
	\includegraphics[width=\textwidth]{images/Capitulo_1/PDS}
	\caption{\textit{Características del PDS.}}
\end{figure}

\subsection{Diseño Conceptual}

El diseño conceptual forma parte del área de proceso creativo del diseño mecatrónico y tiene como objetivo principal dar una solución a un problema de diseño con base en las especificaciones, requerimientos y necesidades planteadas. Por lo tanto, este es precedido por una investigación de mercado y antecedentes que justifiquen el desarrollo de un nuevo producto.  

El diseño conceptual se caracteriza por un alto nivel de abstracción, se ocupa de las propiedades, atributos y funciones principales del producto, y no de dimensiones, materiales y otras características más específicas, ya que éstas se determinan en el diseño detallado. 

Emplea información adquirida de diversas herramientas y métodos a lo largo de todo el proceso, el cual evoluciona de manera constante, más que en cualquier otra etapa del desarrollo de producto, desde la investigación previa, estudio de mercado, el análisis del ciclo de vida, planteamiento del problema, la generación de ideas por medio de bocetos o esquemas, hasta obtener el concepto de diseño del producto, como modelos en 3D o prototipos rápidos. 
Una de las herramientas de las que se vale el diseño conceptual para obtener más información es el \textit{análisis funcional}.

\subsubsection{Análisis funcional en ingeniería}
El análisis funcional, en ingeniería, tiene como objetivo identificar las funciones o prestaciones que el producto debe respetar para cumplir con las necesidades y especificaciones del cliente y traducirlas en requerimientos de diseño. Esto presenta múltiples ventajas \cite{cite_5_2017}:

\begin{itemize}
\item Permite apreciar una visión global del producto que se va a desarrollar.
\item Identifica las funciones más importantes del diseño y la dependencia con las funciones específicas. 
\item Define funciones a partir de las especificaciones dadas por el cliente.
\item Define el problema de diseño antes de definir un mecanismo físico. 
\item Divide el problema principal en sub-problemas y en sub-sub-problemas.  
\item Permite soluciones creativas para cada una de las funciones.
\item Permite alejarse de soluciones ya conocidas. 
\end{itemize}

Para poder comprender mejor el problema de diseño normalmente se hace una descomposición detallada y específica en subfunciones organizadas jerárquicamente, pasando de lo general a lo particular, y esto se hace por medio de los diagramas de funciones. 
El diagrama de funciones puede representar: 

\begin{itemize}
\item Funciones o subfunciones de un sistema representado por medio de bloques.
\item Elementos de entrada y salida de un bloque representado con líneas.
\item Las relaciones entre las funciones o subfunciones.
\item Las secuencias funcionales y caminos para agentes externos, señales, perturbaciones, etc. 
\end{itemize}

Estos diagramas suelen usar símbolos esquemáticos adicionales para mostrar propiedades particulares.
Para realizar un diagrama de funciones se pueden seguir los siguientes procedimientos:
\begin{enumerate}
\item Descripción de las funciones: cuál o cuáles son las operaciones que realiza el producto, y realizar una transición desde su estado de entrada a su estado de salida. 
\item Elaboración del bloque principal: también conocido como modelo de caja negra, que consiste en la función general del producto, los flujos de entrada en el producto y los flujos de salida, es decir, se consideran los elementos de entrada y de salida como: materia, energía, información, etc.

\begin{figure}[H]
\centering
	\includegraphics[scale=.5]{images/Capitulo_1/Funciones1}
	\caption{\textit{Diagrama del modelo de "Caja Negra".}}
\end{figure}
  
\item Líneas de seguimiento: se trazan las líneas de entrada y salida a través del sistema a medida que se van transformado o se van descomponiendo en subfunciones. 

\begin{figure}[H]
\centering
	\includegraphics[scale=.5]{images/Capitulo_1/Funciones2}
	\caption{\textit{Trazo de las líneas de seguimiento.}}
\end{figure}

\item Delimitación de la frontera: como su nombre lo indica, define los límites de las subfunciones o dispositivos. El límite separa las funciones que el dispositivo debe realizar de las funciones que debe realizar otro dispositivo, o que pertenecen a otra área. 
\end{enumerate}

\begin{figure}[H]
\centering
	\includegraphics[width=\textwidth]{images/Capitulo_1/Funciones3}
	\caption{\textit{Delimitación de la frontera.}}
\end{figure}

\begin{figure}[H]
\centering
	\includegraphics[width=\textwidth]{images/Capitulo_1/Diagrama_funciones}
	\caption{\textit{Ejemplo de un diagrama de funciones\cite{cite_5_2017}.}}
\end{figure}

